<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="torchdrug.datasets" href="datasets.html" /><link rel="prev" title="torchdrug.core" href="core.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.04.07"/>
        <title>torchdrug.data - TorchDrug 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=68f4518137b9aefe99b631505a2064c3c42c9852" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --font-stack: Helvetica, Arial, sans-serif, -apple-system;
  --font-stack--monospace: Courier, monospace;
  --color-brand-primary: #E5261F;
  --color-brand-content: #E5261F;
  --admonition-font-size: 1rem;
  --admonition-title-font-size: 1rem;
  --font-size--small--2: var(--font-size--small);
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">TorchDrug 0.2.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="https://torchdrug.ai">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/torchdrug_logo_full.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../benchmark/index.html">Benchmark</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/property_prediction.html">Molecule Property Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/pretrain.html">Pretrained Molecular Representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/generation.html">Molecule Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/retrosynthesis.html">Retrosynthesis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/reasoning.html">Knowledge Graph Reasoning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/property_prediction.html">Property Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/pretrain.html">Pretrained Molecular Representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/generation.html">Molecule Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/retrosynthesis.html">Retrosynthesis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/reasoning.html">Knowledge Graph Reasoning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notes/index.html">Notes</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/graph.html">Graph Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/variadic.html">Batch Irregular Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/layer.html">Graph Neural Network Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/model.html">Customize Models &amp; Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/reference.html">Deal with References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../paper.html">Papers Implemented</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Documentation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="core.html">torchdrug.core</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">torchdrug.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html">torchdrug.datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="transforms.html">torchdrug.transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">torchdrug.metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="layers.html">torchdrug.layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">torchdrug.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html">torchdrug.tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">torchdrug.utils</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="torchdrug-data">
<h1>torchdrug.data<a class="headerlink" href="#torchdrug-data" title="Permalink to this headline">#</a></h1>
<section id="data-structures">
<h2>Data Structures<a class="headerlink" href="#data-structures" title="Permalink to this headline">#</a></h2>
<section id="graph">
<h3>Graph<a class="headerlink" href="#graph" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.Graph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_relation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph" title="Permalink to this definition">#</a></dt>
<dd><p>Basic container for sparse graphs.</p>
<p>To batch graphs with variadic sizes, use <a class="reference internal" href="#torchdrug.data.Graph.pack" title="torchdrug.data.Graph.pack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">data.Graph.pack</span></code></a>.
This will return a PackedGraph object with the following block diagonal adjacency matrix.</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
    A_1    &amp; \cdots &amp; 0      \\
    \vdots &amp; \ddots &amp; \vdots \\
    0      &amp; \cdots &amp; A_n
\end{bmatrix}\end{split}\]</div></div>
<p>where <span class="math notranslate nohighlight">\(A_i\)</span> is the adjacency of <span class="math notranslate nohighlight">\(i\)</span>-th graph.</p>
<p>You may register dynamic attributes for each graph.
The registered attributes will be automatically processed during packing.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This class doesn’t enforce any order on the edges.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">graph</span><span class="o">.</span><span class="n">my_node_attr</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – list of edges of shape <span class="math notranslate nohighlight">\((|E|, 2)\)</span> or <span class="math notranslate nohighlight">\((|E|, 3)\)</span>.
Each tuple is (node_in, node_out) or (node_in, node_out, relation).</p></li>
<li><p><strong>edge_weight</strong> (<em>array_like</em><em>, </em><em>optional</em>) – edge weights of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>num_node</strong> (<em>int</em><em>, </em><em>optional</em>) – number of nodes.
By default, it will be inferred from the largest id in <cite>edge_list</cite></p></li>
<li><p><strong>num_relation</strong> (<em>int</em><em>, </em><em>optional</em>) – number of relations</p></li>
<li><p><strong>node_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – node features of shape <span class="math notranslate nohighlight">\((|V|, ...)\)</span></p></li>
<li><p><strong>edge_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – edge features of shape <span class="math notranslate nohighlight">\((|E|, ...)\)</span></p></li>
<li><p><strong>graph_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – graph feature of any shape</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchdrug.data.Graph.packed_type">
<span class="sig-name descname"><span class="pre">packed_type</span></span><a class="headerlink" href="#torchdrug.data.Graph.packed_type" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#torchdrug.data.PackedGraph" title="torchdrug.data.graph.PackedGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchdrug.data.graph.PackedGraph</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.clone" title="Permalink to this definition">#</a></dt>
<dd><p>Clone this graph.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.compact">
<span class="sig-name descname"><span class="pre">compact</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.compact"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.compact" title="Permalink to this definition">#</a></dt>
<dd><p>Remove isolated nodes and compact node ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.connected_components">
<span class="sig-name descname"><span class="pre">connected_components</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.connected_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.connected_components" title="Permalink to this definition">#</a></dt>
<dd><p>Split this graph into connected components.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>connected components, number of connected components per graph</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(<a class="reference internal" href="#torchdrug.data.PackedGraph" title="torchdrug.data.PackedGraph">PackedGraph</a>, LongTensor)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.copy_">
<span class="sig-name descname"><span class="pre">copy_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.copy_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.copy_" title="Permalink to this definition">#</a></dt>
<dd><p>Copy data from <code class="docutils literal notranslate"><span class="pre">src</span></code> into <code class="docutils literal notranslate"><span class="pre">self</span></code> and return <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">src</span></code> graph must have the same set of attributes as <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.cpu">
<span class="sig-name descname"><span class="pre">cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.cpu" title="Permalink to this definition">#</a></dt>
<dd><p>Return a copy of this graph in CPU memory.</p>
<p>This is a non-op if the graph is already in CPU memory.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.cuda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.cuda" title="Permalink to this definition">#</a></dt>
<dd><p>Return a copy of this graph in CUDA memory.</p>
<p>This is a non-op if the graph is already on the correct device.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.detach" title="Permalink to this definition">#</a></dt>
<dd><p>Detach this graph.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.directed">
<span class="sig-name descname"><span class="pre">directed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.directed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.directed" title="Permalink to this definition">#</a></dt>
<dd><p>Mask the edges to create a directed graph.
Edges that go from a node index to a larger or equal node index will be kept.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>order</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – topological order of the nodes</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.edge">
<span class="sig-name descname"><span class="pre">edge</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.edge" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for edge attributes.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.edge_mask">
<span class="sig-name descname"><span class="pre">edge_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.edge_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.edge_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked graph based on the specified edges.</p>
<p>This function can also be used to re-order the edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – edge index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.edge_reference">
<span class="sig-name descname"><span class="pre">edge_reference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.edge_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.edge_reference" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for edge references.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.from_dense">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adjacency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.from_dense"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.from_dense" title="Permalink to this definition">#</a></dt>
<dd><p>Create a sparse graph from a dense adjacency matrix.
For zero entries in the adjacency matrix, their edge features will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adjacency</strong> (<em>array_like</em>) – adjacency matrix of shape <span class="math notranslate nohighlight">\((|V|, |V|)\)</span> or <span class="math notranslate nohighlight">\((|V|, |V|, |R|)\)</span></p></li>
<li><p><strong>node_feature</strong> (<em>array_like</em>) – node features of shape <span class="math notranslate nohighlight">\((|V|, ...)\)</span></p></li>
<li><p><strong>edge_feature</strong> (<em>array_like</em>) – edge features of shape <span class="math notranslate nohighlight">\((|V|, |V|, ...)\)</span> or <span class="math notranslate nohighlight">\((|V|, |V|, |R|, ...)\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.full">
<span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.full" title="Permalink to this definition">#</a></dt>
<dd><p>Return a fully connected graph over the nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.get_edge">
<span class="sig-name descname"><span class="pre">get_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.get_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.get_edge" title="Permalink to this definition">#</a></dt>
<dd><p>Get the weight of of an edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> (<em>array_like</em>) – index of shape <span class="math notranslate nohighlight">\((2,)\)</span> or <span class="math notranslate nohighlight">\((3,)\)</span></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weight of the edge</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.graph">
<span class="sig-name descname"><span class="pre">graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.graph" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for graph attributes.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.graph_reference">
<span class="sig-name descname"><span class="pre">graph_reference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.graph_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.graph_reference" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for graph references.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.line_graph">
<span class="sig-name descname"><span class="pre">line_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.line_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.line_graph" title="Permalink to this definition">#</a></dt>
<dd><p>Construct a line graph of this graph.
The node feature of the line graph is inherited from the edge feature of the original graph.</p>
<p>In the line graph, each node corresponds to an edge in the original graph.
For a pair of edges (a, b) and (b, c) that share the same intermediate node in the original graph,
there is a directed edge (a, b) -&gt; (b, c) in the line graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.match">
<span class="sig-name descname"><span class="pre">match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.match"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.match" title="Permalink to this definition">#</a></dt>
<dd><p>Return all matched indexes for each pattern. Support patterns with <code class="docutils literal notranslate"><span class="pre">-1</span></code> as the wildcard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pattern</strong> (<em>array_like</em>) – index of shape <span class="math notranslate nohighlight">\((N, 2)\)</span> or <span class="math notranslate nohighlight">\((N, 3)\)</span></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matched indexes, number of matches per edge</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(LongTensor, LongTensor)</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Graph</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span><span class="p">,</span> <span class="n">num_match</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">match</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">num_match</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.node">
<span class="sig-name descname"><span class="pre">node</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.node" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for node attributes.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.node_mask">
<span class="sig-name descname"><span class="pre">node_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.node_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.node_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked graph based on the specified nodes.</p>
<p>This function can also be used to re-order the nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – node index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact node ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">node_mask</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">adjacency</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">node_mask</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.node_reference">
<span class="sig-name descname"><span class="pre">node_reference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.node_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.node_reference" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for node references.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.pack">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graphs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.pack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.pack" title="Permalink to this definition">#</a></dt>
<dd><p>Pack a list of graphs into a PackedGraph object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>graphs</strong> (<em>list of Graph</em>) – list of graphs</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.repeat">
<span class="sig-name descname"><span class="pre">repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.repeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.repeat" title="Permalink to this definition">#</a></dt>
<dd><p>Repeat this graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>count</strong> (<em>int</em>) – number of repetitions</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node2graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.split" title="Permalink to this definition">#</a></dt>
<dd><p>Split a graph into multiple disconnected graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node2graph</strong> (<em>array_like</em>) – ID of the graph each node belongs to</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.subgraph">
<span class="sig-name descname"><span class="pre">subgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.subgraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.subgraph" title="Permalink to this definition">#</a></dt>
<dd><p>Return a subgraph based on the specified nodes.
Equivalent to <a class="reference internal" href="#torchdrug.data.Graph.node_mask" title="torchdrug.data.Graph.node_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">node_mask(index,</span> <span class="pre">compact=True)</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – node index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#torchdrug.data.Graph.node_mask" title="torchdrug.data.Graph.node_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Graph.node_mask()</span></code></a></p>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.to" title="Permalink to this definition">#</a></dt>
<dd><p>Return a copy of this graph on the given device.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.undirected">
<span class="sig-name descname"><span class="pre">undirected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.undirected"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.undirected" title="Permalink to this definition">#</a></dt>
<dd><p>Flip all the edges to create an undirected graph.</p>
<p>For knowledge graphs, the flipped edges can either have the original relation or an inverse relation.
The inverse relation for relation <span class="math notranslate nohighlight">\(r\)</span> is defined as <span class="math notranslate nohighlight">\(|R| + r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>add_inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to use inverse relations for flipped edges</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Graph.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spring'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Graph.visualize" title="Permalink to this definition">#</a></dt>
<dd><p>Visualize this graph with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – title for this graph</p></li>
<li><p><strong>save_file</strong> (<em>str</em><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">png</span></code> or <code class="docutils literal notranslate"><span class="pre">pdf</span></code> file to save visualization.
If not provided, show the figure in window.</p></li>
<li><p><strong>figure_size</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – width and height of the figure</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em>, </em><em>optional</em>) – axis to plot the figure</p></li>
<li><p><strong>layout</strong> (<em>str</em><em>, </em><em>optional</em>) – graph layout</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/reference/drawing.html#module-networkx.drawing.layout">NetworkX graph layout</a></p>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Graph.adjacency">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adjacency</span></span><a class="headerlink" href="#torchdrug.data.Graph.adjacency" title="Permalink to this definition">#</a></dt>
<dd><p>Adjacency matrix of this graph.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">num_relation</span></code> is specified, a sparse tensor of shape <span class="math notranslate nohighlight">\((|V|, |V|, num\_relation)\)</span> will be
returned.
Otherwise, a sparse tensor of shape <span class="math notranslate nohighlight">\((|V|, |V|)\)</span> will be returned.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Graph.batch_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#torchdrug.data.Graph.batch_size" title="Permalink to this definition">#</a></dt>
<dd><p>Batch size.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Graph.degree_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree_in</span></span><a class="headerlink" href="#torchdrug.data.Graph.degree_in" title="Permalink to this definition">#</a></dt>
<dd><p>Weighted number of edges containing each node as input.</p>
<p>Note this is the <strong>out-degree</strong> in graph theory.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Graph.degree_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">degree_out</span></span><a class="headerlink" href="#torchdrug.data.Graph.degree_out" title="Permalink to this definition">#</a></dt>
<dd><p>Weighted number of edges containing each node as output.</p>
<p>Note this is the <strong>in-degree</strong> in graph theory.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Graph.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#torchdrug.data.Graph.device" title="Permalink to this definition">#</a></dt>
<dd><p>Device.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Graph.edge2graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edge2graph</span></span><a class="headerlink" href="#torchdrug.data.Graph.edge2graph" title="Permalink to this definition">#</a></dt>
<dd><p>Edge id to graph id mapping.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Graph.edge_list">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edge_list</span></span><a class="headerlink" href="#torchdrug.data.Graph.edge_list" title="Permalink to this definition">#</a></dt>
<dd><p>List of edges.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Graph.edge_weight">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edge_weight</span></span><a class="headerlink" href="#torchdrug.data.Graph.edge_weight" title="Permalink to this definition">#</a></dt>
<dd><p>Edge weights.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Graph.node2graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">node2graph</span></span><a class="headerlink" href="#torchdrug.data.Graph.node2graph" title="Permalink to this definition">#</a></dt>
<dd><p>Node id to graph id mapping.</p>
</dd></dl>
</dd></dl>
</section>
<section id="molecule">
<h3>Molecule<a class="headerlink" href="#molecule" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.Molecule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">formal_charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explicit_hs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chiral_tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radical_electrons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_stereo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stereo_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Molecules with predefined chemical features.</p>
<p>By nature, molecules are undirected graphs. Each bond is stored as two directed edges in this class.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This class doesn’t enforce any order on edges.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – list of edges of shape <span class="math notranslate nohighlight">\((|E|, 3)\)</span>.
Each tuple is (node_in, node_out, bond_type).</p></li>
<li><p><strong>atom_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – atom types of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>bond_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – bond types of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>formal_charge</strong> (<em>array_like</em><em>, </em><em>optional</em>) – formal charges of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>explicit_hs</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of explicit hydrogens of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>chiral_tag</strong> (<em>array_like</em><em>, </em><em>optional</em>) – chirality tags of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>radical_electrons</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of radical electrons of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>atom_map</strong> (<em>array_likeb optional</em>) – atom mappings of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>bond_stereo</strong> (<em>array_like</em><em>, </em><em>optional</em>) – bond stereochem of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>stereo_atoms</strong> (<em>array_like</em><em>, </em><em>optional</em>) – ids of stereo atoms of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.packed_type">
<span class="sig-name descname"><span class="pre">packed_type</span></span><a class="headerlink" href="#torchdrug.data.Molecule.packed_type" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#torchdrug.data.PackedMolecule" title="torchdrug.data.molecule.PackedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchdrug.data.molecule.PackedMolecule</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.atom">
<span class="sig-name descname"><span class="pre">atom</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.atom" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for atom attributes.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.atom_reference">
<span class="sig-name descname"><span class="pre">atom_reference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.atom_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.atom_reference" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for atom references.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.bond">
<span class="sig-name descname"><span class="pre">bond</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.bond"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.bond" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for bond attributes.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.bond_reference">
<span class="sig-name descname"><span class="pre">bond_reference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.bond_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.bond_reference" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for bond references.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.edge_mask">
<span class="sig-name descname"><span class="pre">edge_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.edge_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.edge_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked graph based on the specified edges.</p>
<p>This function can also be used to re-order the edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – edge index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.from_molecule">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_hydrogen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.from_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.from_molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Create a molecule from an RDKit object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>rdchem.Mol</em>) – molecule</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.from_smiles">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_hydrogen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.from_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.from_smiles" title="Permalink to this definition">#</a></dt>
<dd><p>Create a molecule from a SMILES string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>str</em>) – SMILES string</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.ion_to_molecule">
<span class="sig-name descname"><span class="pre">ion_to_molecule</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.ion_to_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.ion_to_molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Convert ions to molecules by adjusting hydrogens and electrons.</p>
<p>Note [N+] will not be converted.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.mol">
<span class="sig-name descname"><span class="pre">mol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.mol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.mol" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for molecule attributes.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.mol_reference">
<span class="sig-name descname"><span class="pre">mol_reference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.mol_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.mol_reference" title="Permalink to this definition">#</a></dt>
<dd><p>Context mangaer for molecule references.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.node_mask">
<span class="sig-name descname"><span class="pre">node_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.node_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.node_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked graph based on the specified nodes.</p>
<p>This function can also be used to re-order the nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – node index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact node ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">node_mask</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">adjacency</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">node_mask</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.to_molecule">
<span class="sig-name descname"><span class="pre">to_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignore_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.to_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.to_molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Return an RDKit object of this molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ignore_error</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true, return <code class="docutils literal notranslate"><span class="pre">None</span></code> for illegal molecules.
Otherwise, raise an exception.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rdchem.Mol</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.to_scaffold">
<span class="sig-name descname"><span class="pre">to_scaffold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chirality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.to_scaffold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.to_scaffold" title="Permalink to this definition">#</a></dt>
<dd><p>Return a scaffold SMILES string of this molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chirality</strong> (<em>bool</em><em>, </em><em>optional</em>) – consider chirality in the scaffold or not</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.to_smiles">
<span class="sig-name descname"><span class="pre">to_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isomeric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.to_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.to_smiles" title="Permalink to this definition">#</a></dt>
<dd><p>Return a SMILES string of this molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isomeric</strong> (<em>bool</em><em>, </em><em>optional</em>) – keep isomeric information or not</p></li>
<li><p><strong>atom_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – keep atom mapping or not</p></li>
<li><p><strong>canonical</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true, return the canonical form of smiles</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.undirected">
<span class="sig-name descname"><span class="pre">undirected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.undirected"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.undirected" title="Permalink to this definition">#</a></dt>
<dd><p>Flip all the edges to create an undirected graph.</p>
<p>For knowledge graphs, the flipped edges can either have the original relation or an inverse relation.
The inverse relation for relation <span class="math notranslate nohighlight">\(r\)</span> is defined as <span class="math notranslate nohighlight">\(|R| + r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>add_inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to use inverse relations for flipped edges</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Molecule.visualize" title="Permalink to this definition">#</a></dt>
<dd><p>Visualize this molecule with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – title for this molecule</p></li>
<li><p><strong>save_file</strong> (<em>str</em><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">png</span></code> or <code class="docutils literal notranslate"><span class="pre">pdf</span></code> file to save visualization.
If not provided, show the figure in window.</p></li>
<li><p><strong>figure_size</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – width and height of the figure</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em>, </em><em>optional</em>) – axis to plot the figure</p></li>
<li><p><strong>atom_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – visualize atom mapping or not</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.atom2graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom2graph</span></span><a class="headerlink" href="#torchdrug.data.Molecule.atom2graph" title="Permalink to this definition">#</a></dt>
<dd><p>Node id to graph id mapping.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.bond2graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond2graph</span></span><a class="headerlink" href="#torchdrug.data.Molecule.bond2graph" title="Permalink to this definition">#</a></dt>
<dd><p>Edge id to graph id mapping.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Molecule.is_valid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_valid</span></span><a class="headerlink" href="#torchdrug.data.Molecule.is_valid" title="Permalink to this definition">#</a></dt>
<dd><p>A coarse implementation of valence check.</p>
</dd></dl>
</dd></dl>
</section>
<section id="protein">
<h3>Protein<a class="headerlink" href="#protein" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.Protein">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Protein</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2residue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_hetero_atom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">insertion_code</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chain_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein" title="Permalink to this definition">#</a></dt>
<dd><p>Proteins with predefined chemical features.
Support both residue-level and atom-level operations and ensure consistency between two views.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The order of residues must be the same as the protein sequence.
However, this class doesn’t enforce any order on nodes or edges.
Nodes may have a different order with residues.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – list of edges of shape <span class="math notranslate nohighlight">\((|E|, 3)\)</span>.
Each tuple is (node_in, node_out, bond_type).</p></li>
<li><p><strong>atom_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – atom types of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>bond_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – bond types of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>residue_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – residue types of shape <span class="math notranslate nohighlight">\((|V_{res}|,)\)</span></p></li>
<li><p><strong>view</strong> (<em>str</em><em>, </em><em>optional</em>) – default view for this protein. Can be <code class="docutils literal notranslate"><span class="pre">atom</span></code> or <code class="docutils literal notranslate"><span class="pre">residue</span></code>.</p></li>
<li><p><strong>atom_name</strong> (<em>array_like</em><em>, </em><em>optional</em>) – atom names in a residue of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>atom2residue</strong> (<em>array_like</em><em>, </em><em>optional</em>) – atom id to residue id mapping of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>residue_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – residue features of shape <span class="math notranslate nohighlight">\((|V_{res}|, ...)\)</span></p></li>
<li><p><strong>is_hetero_atom</strong> (<em>array_like</em><em>, </em><em>optional</em>) – hetero atom indicators of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>occupancy</strong> (<em>array_like</em><em>, </em><em>optional</em>) – occupancy of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>b_factor</strong> (<em>array_like</em><em>, </em><em>optional</em>) – temperature factors of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>residue_number</strong> (<em>array_like</em><em>, </em><em>optional</em>) – residue numbers of shape <span class="math notranslate nohighlight">\((|V_{res}|,)\)</span></p></li>
<li><p><strong>insertion_code</strong> (<em>array_like</em><em>, </em><em>optional</em>) – insertion codes of shape <span class="math notranslate nohighlight">\((|V_{res}|,)\)</span></p></li>
<li><p><strong>chain_id</strong> (<em>array_like</em><em>, </em><em>optional</em>) – chain ids of shape <span class="math notranslate nohighlight">\((|V_{res}|,)\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchdrug.data.Protein.packed_type">
<span class="sig-name descname"><span class="pre">packed_type</span></span><a class="headerlink" href="#torchdrug.data.Protein.packed_type" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#torchdrug.data.PackedProtein" title="torchdrug.data.protein.PackedProtein"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchdrug.data.protein.PackedProtein</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.from_molecule">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.from_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.from_molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Create a protein from an RDKit object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>rdchem.Mol</em>) – molecule</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.from_pdb">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdb_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.from_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.from_pdb" title="Permalink to this definition">#</a></dt>
<dd><p>Create a protein from a PDB file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdb_file</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.from_sequence">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.from_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.from_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Create a protein from a sequence.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It takes considerable time to construct proteins with a large number of atoms and bonds.
If you only need residue information, you may speed up the construction by setting
<code class="docutils literal notranslate"><span class="pre">atom_feature</span></code> and <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code> to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> (<em>str</em>) – protein sequence</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.pack">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graphs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.pack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.pack" title="Permalink to this definition">#</a></dt>
<dd><p>Pack a list of graphs into a PackedGraph object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>graphs</strong> (<em>list of Graph</em>) – list of graphs</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.repeat">
<span class="sig-name descname"><span class="pre">repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.repeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.repeat" title="Permalink to this definition">#</a></dt>
<dd><p>Repeat this graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>count</strong> (<em>int</em>) – number of repetitions</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.residue">
<span class="sig-name descname"><span class="pre">residue</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.residue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.residue" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for residue attributes.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.residue2atom">
<span class="sig-name descname"><span class="pre">residue2atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residue_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.residue2atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.residue2atom" title="Permalink to this definition">#</a></dt>
<dd><p>Map residue ids to atom ids.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.residue_mask">
<span class="sig-name descname"><span class="pre">residue_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.residue_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.residue_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked protein based on the specified residues.</p>
<p>Note the compact option is applied to both residue and atom ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – residue index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact residue ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Protein</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.residue_reference">
<span class="sig-name descname"><span class="pre">residue_reference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.residue_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.residue_reference" title="Permalink to this definition">#</a></dt>
<dd><p>Context manager for residue references.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node2graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.split" title="Permalink to this definition">#</a></dt>
<dd><p>Split a graph into multiple disconnected graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node2graph</strong> (<em>array_like</em>) – ID of the graph each node belongs to</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.subresidue">
<span class="sig-name descname"><span class="pre">subresidue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.subresidue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.subresidue" title="Permalink to this definition">#</a></dt>
<dd><p>Return a subgraph based on the specified residues.
Equivalent to <a class="reference internal" href="#torchdrug.data.Protein.residue_mask" title="torchdrug.data.Protein.residue_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">residue_mask(index,</span> <span class="pre">compact=True)</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – residue index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Protein</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#torchdrug.data.Protein.residue_mask" title="torchdrug.data.Protein.residue_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Protein.residue_mask()</span></code></a></p>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.to_molecule">
<span class="sig-name descname"><span class="pre">to_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignore_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.to_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.to_molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Return an RDKit object of this protein.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ignore_error</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true, return <code class="docutils literal notranslate"><span class="pre">None</span></code> for illegal molecules.
Otherwise, raise an exception.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rdchem.Mol</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.to_pdb">
<span class="sig-name descname"><span class="pre">to_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.to_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.to_pdb" title="Permalink to this definition">#</a></dt>
<dd><p>Write this protein to a pdb file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pdb_file</strong> (<em>str</em>) – file name</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Protein.to_sequence">
<span class="sig-name descname"><span class="pre">to_sequence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#Protein.to_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Protein.to_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Return a sequence of this protein.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Protein.connected_component_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">connected_component_id</span></span><a class="headerlink" href="#torchdrug.data.Protein.connected_component_id" title="Permalink to this definition">#</a></dt>
<dd><p>Connected component id of each residue.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Protein.residue2graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">residue2graph</span></span><a class="headerlink" href="#torchdrug.data.Protein.residue2graph" title="Permalink to this definition">#</a></dt>
<dd><p>Residue id to graph id mapping.</p>
</dd></dl>
</dd></dl>
</section>
<section id="packedgraph">
<h3>PackedGraph<a class="headerlink" href="#packedgraph" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PackedGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_relation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph" title="Permalink to this definition">#</a></dt>
<dd><p>Container for sparse graphs with variadic sizes.</p>
<p>To create a PackedGraph from Graph objects</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">graphs</span><span class="p">)</span>
</pre></div>
</div>
<p>To retrieve Graph objects from a PackedGraph</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graphs</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">unpack</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Edges of the same graph are guaranteed to be consecutive in the edge list.
However, this class doesn’t enforce any order on the edges.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – list of edges of shape <span class="math notranslate nohighlight">\((|E|, 2)\)</span> or <span class="math notranslate nohighlight">\((|E|, 3)\)</span>.
Each tuple is (node_in, node_out) or (node_in, node_out, relation).</p></li>
<li><p><strong>edge_weight</strong> (<em>array_like</em><em>, </em><em>optional</em>) – edge weights of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>num_nodes</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of nodes in each graph
By default, it will be inferred from the largest id in <cite>edge_list</cite></p></li>
<li><p><strong>num_edges</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of edges in each graph</p></li>
<li><p><strong>num_relation</strong> (<em>int</em><em>, </em><em>optional</em>) – number of relations</p></li>
<li><p><strong>node_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – node features of shape <span class="math notranslate nohighlight">\((|V|, ...)\)</span></p></li>
<li><p><strong>edge_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – edge features of shape <span class="math notranslate nohighlight">\((|E|, ...)\)</span></p></li>
<li><p><strong>offsets</strong> (<em>array_like</em><em>, </em><em>optional</em>) – node id offsets of shape <span class="math notranslate nohighlight">\((|E|,)\)</span>.
If not provided, nodes in <cite>edge_list</cite> should be relative index, i.e., the index in each graph.
If provided, nodes in <cite>edge_list</cite> should be absolute index, i.e., the index in the packed graph.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.unpacked_type">
<span class="sig-name descname"><span class="pre">unpacked_type</span></span><a class="headerlink" href="#torchdrug.data.PackedGraph.unpacked_type" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#torchdrug.data.Graph" title="torchdrug.data.graph.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchdrug.data.graph.Graph</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.clone" title="Permalink to this definition">#</a></dt>
<dd><p>Clone this packed graph.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.cpu">
<span class="sig-name descname"><span class="pre">cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.cpu" title="Permalink to this definition">#</a></dt>
<dd><p>Return a copy of this packed graph in CPU memory.</p>
<p>This is a non-op if the graph is already in CPU memory.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.cuda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.cuda" title="Permalink to this definition">#</a></dt>
<dd><p>Return a copy of this packed graph in CUDA memory.</p>
<p>This is a non-op if the graph is already on the correct device.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.detach" title="Permalink to this definition">#</a></dt>
<dd><p>Detach this packed graph.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.edge_mask">
<span class="sig-name descname"><span class="pre">edge_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.edge_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.edge_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked packed graph based on the specified edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – edge index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.full">
<span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.full" title="Permalink to this definition">#</a></dt>
<dd><p>Return a pack of fully connected graphs.</p>
<p>This is useful for computing node-pair-wise features.
The computation can be implemented as message passing over a fully connected graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.get_item">
<span class="sig-name descname"><span class="pre">get_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.get_item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.get_item" title="Permalink to this definition">#</a></dt>
<dd><p>Get the i-th graph from this packed graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) – graph index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.graph_mask">
<span class="sig-name descname"><span class="pre">graph_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.graph_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.graph_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked packed graph based on the specified graphs.</p>
<p>This function can also be used to re-order the graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – graph index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact graph ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.line_graph">
<span class="sig-name descname"><span class="pre">line_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.line_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.line_graph" title="Permalink to this definition">#</a></dt>
<dd><p>Construct a packed line graph of this packed graph.
The node features of the line graphs are inherited from the edge features of the original graphs.</p>
<p>In the line graph, each node corresponds to an edge in the original graph.
For a pair of edges (a, b) and (b, c) that share the same intermediate node in the original graph,
there is a directed edge (a, b) -&gt; (b, c) in the line graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph2graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.merge" title="Permalink to this definition">#</a></dt>
<dd><p>Merge multiple graphs into a single graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>graph2graph</strong> (<em>array_like</em>) – ID of the new graph each graph belongs to</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.node_mask">
<span class="sig-name descname"><span class="pre">node_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.node_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.node_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked packed graph based on the specified nodes.</p>
<p>Note the compact option is only applied to node ids but not graph ids.
To generate compact graph ids, use <a class="reference internal" href="#torchdrug.data.PackedGraph.subbatch" title="torchdrug.data.PackedGraph.subbatch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subbatch()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – node index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact node ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.repeat">
<span class="sig-name descname"><span class="pre">repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.repeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.repeat" title="Permalink to this definition">#</a></dt>
<dd><p>Repeat this packed graph. This function behaves similarly to <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.repeat.html">torch.Tensor.repeat</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>count</strong> (<em>int</em>) – number of repetitions</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.repeat_interleave">
<span class="sig-name descname"><span class="pre">repeat_interleave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repeats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.repeat_interleave"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.repeat_interleave" title="Permalink to this definition">#</a></dt>
<dd><p>Repeat this packed graph. This function behaves similarly to <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.repeat_interleave.html">torch.repeat_interleave</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>repeats</strong> (<em>Tensor</em><em> or </em><em>int</em>) – number of repetitions for each graph</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.subbatch">
<span class="sig-name descname"><span class="pre">subbatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.subbatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.subbatch" title="Permalink to this definition">#</a></dt>
<dd><p>Return a subbatch based on the specified graphs.
Equivalent to <a class="reference internal" href="#torchdrug.data.PackedGraph.graph_mask" title="torchdrug.data.PackedGraph.graph_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">graph_mask(index,</span> <span class="pre">compact=True)</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – graph index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#torchdrug.data.PackedGraph.graph_mask" title="torchdrug.data.PackedGraph.graph_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PackedGraph.graph_mask()</span></code></a></p>
</div>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.undirected">
<span class="sig-name descname"><span class="pre">undirected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.undirected"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.undirected" title="Permalink to this definition">#</a></dt>
<dd><p>Flip all the edges to create undirected graphs.</p>
<p>For knowledge graphs, the flipped edges can either have the original relation or an inverse relation.
The inverse relation for relation <span class="math notranslate nohighlight">\(r\)</span> is defined as <span class="math notranslate nohighlight">\(|R| + r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>add_inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to use inverse relations for flipped edges</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.unpack">
<span class="sig-name descname"><span class="pre">unpack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.unpack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.unpack" title="Permalink to this definition">#</a></dt>
<dd><p>Unpack this packed graph into a list of graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.unpack_data">
<span class="sig-name descname"><span class="pre">unpack_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.unpack_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.unpack_data" title="Permalink to this definition">#</a></dt>
<dd><p>Unpack node or edge data according to the packed graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Tensor</em>) – data to unpack</p></li>
<li><p><strong>type</strong> (<em>str</em><em>, </em><em>optional</em>) – data type. Can be <code class="docutils literal notranslate"><span class="pre">auto</span></code>, <code class="docutils literal notranslate"><span class="pre">node</span></code>, or <code class="docutils literal notranslate"><span class="pre">edge</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">titles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spring'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.visualize" title="Permalink to this definition">#</a></dt>
<dd><p>Visualize the packed graphs with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>titles</strong> (<em>list of str</em><em>, </em><em>optional</em>) – title for each graph. Default is the ID of each graph.</p></li>
<li><p><strong>save_file</strong> (<em>str</em><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">png</span></code> or <code class="docutils literal notranslate"><span class="pre">pdf</span></code> file to save visualization.
If not provided, show the figure in window.</p></li>
<li><p><strong>figure_size</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – width and height of the figure</p></li>
<li><p><strong>layout</strong> (<em>str</em><em>, </em><em>optional</em>) – graph layout</p></li>
<li><p><strong>num_row</strong> (<em>int</em><em>, </em><em>optional</em>) – number of rows in the figure</p></li>
<li><p><strong>num_col</strong> (<em>int</em><em>, </em><em>optional</em>) – number of columns in the figure</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/reference/drawing.html#module-networkx.drawing.layout">NetworkX graph layout</a></p>
</div>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.batch_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#torchdrug.data.PackedGraph.batch_size" title="Permalink to this definition">#</a></dt>
<dd><p>Batch size.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.edge2graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edge2graph</span></span><a class="headerlink" href="#torchdrug.data.PackedGraph.edge2graph" title="Permalink to this definition">#</a></dt>
<dd><p>Edge id to graph id mapping.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.PackedGraph.node2graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">node2graph</span></span><a class="headerlink" href="#torchdrug.data.PackedGraph.node2graph" title="Permalink to this definition">#</a></dt>
<dd><p>Node id to graph id mapping.</p>
</dd></dl>
</dd></dl>
</section>
<section id="packedmolecule">
<h3>PackedMolecule<a class="headerlink" href="#packedmolecule" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PackedMolecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule" title="Permalink to this definition">#</a></dt>
<dd><p>Container for molecules with variadic sizes.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Edges of the same molecule are guaranteed to be consecutive in the edge list.
However, this class doesn’t enforce any order on the edges.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – list of edges of shape <span class="math notranslate nohighlight">\((|E|, 3)\)</span>.
Each tuple is (node_in, node_out, bond_type).</p></li>
<li><p><strong>atom_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – atom types of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>bond_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – bond types of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>num_nodes</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of nodes in each graph
By default, it will be inferred from the largest id in <cite>edge_list</cite></p></li>
<li><p><strong>num_edges</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of edges in each graph</p></li>
<li><p><strong>offsets</strong> (<em>array_like</em><em>, </em><em>optional</em>) – node id offsets of shape <span class="math notranslate nohighlight">\((|E|,)\)</span>.
If not provided, nodes in <cite>edge_list</cite> should be relative index, i.e., the index in each graph.
If provided, nodes in <cite>edge_list</cite> should be absolute index, i.e., the index in the packed graph.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.unpacked_type">
<span class="sig-name descname"><span class="pre">unpacked_type</span></span><a class="headerlink" href="#torchdrug.data.PackedMolecule.unpacked_type" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#torchdrug.data.Molecule" title="torchdrug.data.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchdrug.data.molecule.Molecule</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.edge_mask">
<span class="sig-name descname"><span class="pre">edge_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.edge_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.edge_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked packed graph based on the specified edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – edge index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.from_molecule">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_hydrogen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.from_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.from_molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Create a packed molecule from a list of RDKit objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mols</strong> (<em>list of rdchem.Mol</em>) – molecules</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.from_smiles">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_hydrogen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.from_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.from_smiles" title="Permalink to this definition">#</a></dt>
<dd><p>Create a packed molecule from a list of SMILES strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_list</strong> (<em>str</em>) – list of SMILES strings</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.ion_to_molecule">
<span class="sig-name descname"><span class="pre">ion_to_molecule</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.ion_to_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.ion_to_molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Convert ions to molecules by adjusting hydrogens and electrons.</p>
<p>Note [N+] will not be converted.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.node_mask">
<span class="sig-name descname"><span class="pre">node_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.node_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.node_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked packed graph based on the specified nodes.</p>
<p>Note the compact option is only applied to node ids but not graph ids.
To generate compact graph ids, use <code class="xref py py-meth docutils literal notranslate"><span class="pre">subbatch()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – node index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact node ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.to_molecule">
<span class="sig-name descname"><span class="pre">to_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignore_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.to_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.to_molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of RDKit objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ignore_error</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true, return <code class="docutils literal notranslate"><span class="pre">None</span></code> for illegal molecules.
Otherwise, raise an exception.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of rdchem.Mol</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.to_smiles">
<span class="sig-name descname"><span class="pre">to_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">isomeric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canonical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.to_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.to_smiles" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of SMILES strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isomeric</strong> (<em>bool</em><em>, </em><em>optional</em>) – keep isomeric information or not</p></li>
<li><p><strong>atom_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – keep atom mapping or not</p></li>
<li><p><strong>canonical</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true, return the canonical form of smiles</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of str</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.undirected">
<span class="sig-name descname"><span class="pre">undirected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.undirected"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.undirected" title="Permalink to this definition">#</a></dt>
<dd><p>Flip all the edges to create undirected graphs.</p>
<p>For knowledge graphs, the flipped edges can either have the original relation or an inverse relation.
The inverse relation for relation <span class="math notranslate nohighlight">\(r\)</span> is defined as <span class="math notranslate nohighlight">\(|R| + r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>add_inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to use inverse relations for flipped edges</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">titles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(3,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.visualize" title="Permalink to this definition">#</a></dt>
<dd><p>Visualize the packed molecules with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>titles</strong> (<em>list of str</em><em>, </em><em>optional</em>) – title for each molecule. Default is the ID of each molecule.</p></li>
<li><p><strong>save_file</strong> (<em>str</em><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">png</span></code> or <code class="docutils literal notranslate"><span class="pre">pdf</span></code> file to save visualization.
If not provided, show the figure in window.</p></li>
<li><p><strong>figure_size</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – width and height of the figure</p></li>
<li><p><strong>num_row</strong> (<em>int</em><em>, </em><em>optional</em>) – number of rows in the figure</p></li>
<li><p><strong>num_col</strong> (<em>int</em><em>, </em><em>optional</em>) – number of columns in the figure</p></li>
<li><p><strong>atom_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – visualize atom mapping or not</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.atom2graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom2graph</span></span><a class="headerlink" href="#torchdrug.data.PackedMolecule.atom2graph" title="Permalink to this definition">#</a></dt>
<dd><p>Node id to graph id mapping.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.bond2graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond2graph</span></span><a class="headerlink" href="#torchdrug.data.PackedMolecule.bond2graph" title="Permalink to this definition">#</a></dt>
<dd><p>Edge id to graph id mapping.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.PackedMolecule.is_valid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_valid</span></span><a class="headerlink" href="#torchdrug.data.PackedMolecule.is_valid" title="Permalink to this definition">#</a></dt>
<dd><p>A coarse implementation of valence check.</p>
</dd></dl>
</dd></dl>
</section>
<section id="packedprotein">
<h3>PackedProtein<a class="headerlink" href="#packedprotein" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PackedProtein</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_residues</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein" title="Permalink to this definition">#</a></dt>
<dd><p>Container for proteins with variadic sizes.
Support both residue-level and atom-level operations and ensure consistency between two views.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Edges of the same graph are guaranteed to be consecutive in the edge list.
The order of residues must be the same as the protein sequence.
However, this class doesn’t enforce any order on nodes or edges.
Nodes may have a different order with residues.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – list of edges of shape <span class="math notranslate nohighlight">\((|E|, 3)\)</span>.
Each tuple is (node_in, node_out, bond_type).</p></li>
<li><p><strong>atom_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – atom types of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>bond_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – bond types of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>residue_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – residue types of shape <span class="math notranslate nohighlight">\((|V_{res}|,)\)</span></p></li>
<li><p><strong>view</strong> (<em>str</em><em>, </em><em>optional</em>) – default view for this protein. Can be <code class="docutils literal notranslate"><span class="pre">atom</span></code> or <code class="docutils literal notranslate"><span class="pre">residue</span></code>.</p></li>
<li><p><strong>num_nodes</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of nodes in each graph
By default, it will be inferred from the largest id in <cite>edge_list</cite></p></li>
<li><p><strong>num_edges</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of edges in each graph</p></li>
<li><p><strong>num_residues</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of residues in each graph</p></li>
<li><p><strong>offsets</strong> (<em>array_like</em><em>, </em><em>optional</em>) – node id offsets of shape <span class="math notranslate nohighlight">\((|E|,)\)</span>.
If not provided, nodes in <cite>edge_list</cite> should be relative index, i.e., the index in each graph.
If provided, nodes in <cite>edge_list</cite> should be absolute index, i.e., the index in the packed graph.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.unpacked_type">
<span class="sig-name descname"><span class="pre">unpacked_type</span></span><a class="headerlink" href="#torchdrug.data.PackedProtein.unpacked_type" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <a class="reference internal" href="#torchdrug.data.Protein" title="torchdrug.data.protein.Protein"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchdrug.data.protein.Protein</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.clone" title="Permalink to this definition">#</a></dt>
<dd><p>Clone this packed graph.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.cpu">
<span class="sig-name descname"><span class="pre">cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.cpu" title="Permalink to this definition">#</a></dt>
<dd><p>Return a copy of this packed graph in CPU memory.</p>
<p>This is a non-op if the graph is already in CPU memory.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.cuda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.cuda" title="Permalink to this definition">#</a></dt>
<dd><p>Return a copy of this packed graph in CUDA memory.</p>
<p>This is a non-op if the graph is already on the correct device.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.detach" title="Permalink to this definition">#</a></dt>
<dd><p>Detach this packed graph.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.edge_mask">
<span class="sig-name descname"><span class="pre">edge_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.edge_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.edge_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked packed graph based on the specified edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – edge index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.from_molecule">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.from_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.from_molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Create a packed protein from a list of RDKit objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mols</strong> (<em>list of rdchem.Mol</em>) – molecules</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.from_pdb">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdb_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.from_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.from_pdb" title="Permalink to this definition">#</a></dt>
<dd><p>Create a protein from a list of PDB files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdb_files</strong> (<em>str</em>) – list of file names</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.from_sequence">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.from_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.from_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Create a packed protein from a list of sequences.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It takes considerable time to construct proteins with a large number of atoms and bonds.
If you only need residue information, you may speed up the construction by setting
<code class="docutils literal notranslate"><span class="pre">atom_feature</span></code> and <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code> to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequences</strong> (<em>str</em>) – list of protein sequences</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.get_item">
<span class="sig-name descname"><span class="pre">get_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.get_item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.get_item" title="Permalink to this definition">#</a></dt>
<dd><p>Get the i-th graph from this packed graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) – graph index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.graph_mask">
<span class="sig-name descname"><span class="pre">graph_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.graph_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.graph_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked packed graph based on the specified graphs.</p>
<p>This function can also be used to re-order the graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – graph index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact graph ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph2graph</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.merge" title="Permalink to this definition">#</a></dt>
<dd><p>Merge multiple graphs into a single graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>graph2graph</strong> (<em>array_like</em>) – ID of the new graph each graph belongs to</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.node_mask">
<span class="sig-name descname"><span class="pre">node_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.node_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.node_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked packed graph based on the specified nodes.</p>
<p>Note the compact option is only applied to node ids but not graph ids.
To generate compact graph ids, use <code class="xref py py-meth docutils literal notranslate"><span class="pre">subbatch()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – node index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact node ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.repeat">
<span class="sig-name descname"><span class="pre">repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.repeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.repeat" title="Permalink to this definition">#</a></dt>
<dd><p>Repeat this packed graph. This function behaves similarly to <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.repeat.html">torch.Tensor.repeat</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>count</strong> (<em>int</em>) – number of repetitions</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.repeat_interleave">
<span class="sig-name descname"><span class="pre">repeat_interleave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repeats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.repeat_interleave"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.repeat_interleave" title="Permalink to this definition">#</a></dt>
<dd><p>Repeat this packed graph. This function behaves similarly to <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.repeat_interleave.html">torch.repeat_interleave</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>repeats</strong> (<em>Tensor</em><em> or </em><em>int</em>) – number of repetitions for each graph</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.residue_mask">
<span class="sig-name descname"><span class="pre">residue_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.residue_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.residue_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Return a masked packed protein based on the specified residues.</p>
<p>Note the compact option is applied to both residue and atom ids, but not graph ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – residue index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact residue ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedProtein</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.to_molecule">
<span class="sig-name descname"><span class="pre">to_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignore_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.to_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.to_molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of RDKit objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ignore_error</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true, return <code class="docutils literal notranslate"><span class="pre">None</span></code> for illegal molecules.
Otherwise, raise an exception.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of rdchem.Mol</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.to_pdb">
<span class="sig-name descname"><span class="pre">to_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_files</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.to_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.to_pdb" title="Permalink to this definition">#</a></dt>
<dd><p>Write this packed protein to several pdb files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pdb_files</strong> (<em>list of str</em>) – list of file names</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.to_sequence">
<span class="sig-name descname"><span class="pre">to_sequence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.to_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.to_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Return a list of sequences.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.undirected">
<span class="sig-name descname"><span class="pre">undirected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/protein.html#PackedProtein.undirected"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.PackedProtein.undirected" title="Permalink to this definition">#</a></dt>
<dd><p>Flip all the edges to create undirected graphs.</p>
<p>For knowledge graphs, the flipped edges can either have the original relation or an inverse relation.
The inverse relation for relation <span class="math notranslate nohighlight">\(r\)</span> is defined as <span class="math notranslate nohighlight">\(|R| + r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>add_inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to use inverse relations for flipped edges</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.connected_component_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">connected_component_id</span></span><a class="headerlink" href="#torchdrug.data.PackedProtein.connected_component_id" title="Permalink to this definition">#</a></dt>
<dd><p>Connected component id of each residue.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.PackedProtein.residue2graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">residue2graph</span></span><a class="headerlink" href="#torchdrug.data.PackedProtein.residue2graph" title="Permalink to this definition">#</a></dt>
<dd><p>Residue id to graph id mapping.</p>
</dd></dl>
</dd></dl>
</section>
<section id="dictionary">
<h3>Dictionary<a class="headerlink" href="#dictionary" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.Dictionary">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Dictionary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dictionary.html#Dictionary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Dictionary" title="Permalink to this definition">#</a></dt>
<dd><p>Dictionary for mapping keys to values.</p>
<p>This class has the same behavior as the built-in dict, except it operates on tensors and support batching.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keys</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">d</span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]]</span> <span class="o">==</span> <span class="n">values</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">has_key</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<em>LongTensor</em>) – keys of shape <span class="math notranslate nohighlight">\((N,)\)</span> or <span class="math notranslate nohighlight">\((N, D)\)</span></p></li>
<li><p><strong>values</strong> (<em>Tensor</em>) – values of shape <span class="math notranslate nohighlight">\((N, ...)\)</span></p></li>
<li><p><strong>hash</strong> (<em>PerfectHash</em><em>, </em><em>optional</em>) – hash function for keys</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Dictionary.cpu">
<span class="sig-name descname"><span class="pre">cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dictionary.html#Dictionary.cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Dictionary.cpu" title="Permalink to this definition">#</a></dt>
<dd><p>Return a copy of this dictionary in CPU memory.</p>
<p>This is a non-op if the dictionary is already in CPU memory.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Dictionary.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dictionary.html#Dictionary.cuda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Dictionary.cuda" title="Permalink to this definition">#</a></dt>
<dd><p>Return a copy of this dictionary in CUDA memory.</p>
<p>This is a non-op if the dictionary is already in CUDA memory.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Dictionary.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dictionary.html#Dictionary.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Dictionary.get" title="Permalink to this definition">#</a></dt>
<dd><p>Return the value for each key if the key is in the dictionary, otherwise the default value is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<em>LongTensor</em>) – keys of arbitrary shape</p></li>
<li><p><strong>default</strong> (<em>int</em><em> or </em><em>Tensor</em><em>, </em><em>optional</em>) – default return value. By default, 0 is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Dictionary.has_key">
<span class="sig-name descname"><span class="pre">has_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dictionary.html#Dictionary.has_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Dictionary.has_key" title="Permalink to this definition">#</a></dt>
<dd><p>Check whether each key exists in the dictionary.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.Dictionary.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dictionary.html#Dictionary.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.Dictionary.to_dict" title="Permalink to this definition">#</a></dt>
<dd><p>Return a built-in dict object of this dictionary.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.Dictionary.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#torchdrug.data.Dictionary.device" title="Permalink to this definition">#</a></dt>
<dd><p>Device.</p>
</dd></dl>
</dd></dl>
</section>
</section>
<section id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline">#</a></h2>
<section id="knowledgegraphdataset">
<h3>KnowledgeGraphDataset<a class="headerlink" href="#knowledgegraphdataset" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.KnowledgeGraphDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">KnowledgeGraphDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#KnowledgeGraphDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Knowledge graph dataset.</p>
<p>The whole dataset contains one knowledge graph.</p>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.KnowledgeGraphDataset.load_triplet">
<span class="sig-name descname"><span class="pre">load_triplet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">triplets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_vocab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation_vocab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_entity_vocab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv_relation_vocab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#KnowledgeGraphDataset.load_triplet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.load_triplet" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from triplets.
The mapping between indexes and tokens is specified through either vocabularies or inverse vocabularies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>triplets</strong> (<em>array_like</em>) – triplets of shape <span class="math notranslate nohighlight">\((n, 3)\)</span></p></li>
<li><p><strong>entity_vocab</strong> (<em>dict of str</em><em>, </em><em>optional</em>) – maps entity indexes to tokens</p></li>
<li><p><strong>relation_vocab</strong> (<em>dict of str</em><em>, </em><em>optional</em>) – maps relation indexes to tokens</p></li>
<li><p><strong>inv_entity_vocab</strong> (<em>dict of str</em><em>, </em><em>optional</em>) – maps tokens to entity indexes</p></li>
<li><p><strong>inv_relation_vocab</strong> (<em>dict of str</em><em>, </em><em>optional</em>) – maps tokens to relation indexes</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.KnowledgeGraphDataset.load_tsv">
<span class="sig-name descname"><span class="pre">load_tsv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tsv_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#KnowledgeGraphDataset.load_tsv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.load_tsv" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from a tsv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tsv_file</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.KnowledgeGraphDataset.load_tsvs">
<span class="sig-name descname"><span class="pre">load_tsvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tsv_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#KnowledgeGraphDataset.load_tsvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.load_tsvs" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from multiple tsv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tsv_files</strong> (<em>list of str</em>) – list of file names</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.KnowledgeGraphDataset.num_entity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_entity</span></span><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.num_entity" title="Permalink to this definition">#</a></dt>
<dd><p>Number of entities.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.KnowledgeGraphDataset.num_relation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_relation</span></span><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.num_relation" title="Permalink to this definition">#</a></dt>
<dd><p>Number of relations.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.KnowledgeGraphDataset.num_triplet">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_triplet</span></span><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.num_triplet" title="Permalink to this definition">#</a></dt>
<dd><p>Number of triplets.</p>
</dd></dl>
</dd></dl>
</section>
<section id="moleculedataset">
<h3>MoleculeDataset<a class="headerlink" href="#moleculedataset" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MoleculeDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#MoleculeDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.MoleculeDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Molecule dataset.</p>
<p>Each sample contains a molecule graph, and any number of prediction targets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.load_csv">
<span class="sig-name descname"><span class="pre">load_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'smiles'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_hydrogen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#MoleculeDataset.load_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.MoleculeDataset.load_csv" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from a csv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csv_file</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>smiles_field</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the SMILES column in the table.
Use <code class="docutils literal notranslate"><span class="pre">None</span></code> if there is no SMILES column.</p></li>
<li><p><strong>target_fields</strong> (<em>list of str</em><em>, </em><em>optional</em>) – name of target columns in the table.
Default is all columns other than the SMILES column.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – data transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the molecules are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.load_pickle">
<span class="sig-name descname"><span class="pre">load_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pkl_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#MoleculeDataset.load_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.MoleculeDataset.load_pickle" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pkl_file</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.load_smiles">
<span class="sig-name descname"><span class="pre">load_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_hydrogen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#MoleculeDataset.load_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.MoleculeDataset.load_smiles" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from SMILES and targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_list</strong> (<em>list of str</em>) – SMILES strings</p></li>
<li><p><strong>targets</strong> (<em>dict of list</em>) – prediction targets</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – data transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the molecules are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.save_pickle">
<span class="sig-name descname"><span class="pre">save_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pkl_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#MoleculeDataset.save_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.MoleculeDataset.save_pickle" title="Permalink to this definition">#</a></dt>
<dd><p>Save the dataset to a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pkl_file</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.atom_types">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_types</span></span><a class="headerlink" href="#torchdrug.data.MoleculeDataset.atom_types" title="Permalink to this definition">#</a></dt>
<dd><p>All atom types.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.bond_types">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond_types</span></span><a class="headerlink" href="#torchdrug.data.MoleculeDataset.bond_types" title="Permalink to this definition">#</a></dt>
<dd><p>All bond types.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.edge_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edge_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.MoleculeDataset.edge_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of edge features.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.node_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">node_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.MoleculeDataset.node_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of node features.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.num_atom_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_atom_type</span></span><a class="headerlink" href="#torchdrug.data.MoleculeDataset.num_atom_type" title="Permalink to this definition">#</a></dt>
<dd><p>Number of different atom types.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.num_bond_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_bond_type</span></span><a class="headerlink" href="#torchdrug.data.MoleculeDataset.num_bond_type" title="Permalink to this definition">#</a></dt>
<dd><p>Number of different bond types.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.MoleculeDataset.tasks">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tasks</span></span><a class="headerlink" href="#torchdrug.data.MoleculeDataset.tasks" title="Permalink to this definition">#</a></dt>
<dd><p>List of tasks.</p>
</dd></dl>
</dd></dl>
</section>
<section id="proteindataset">
<h3>ProteinDataset<a class="headerlink" href="#proteindataset" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.ProteinDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ProteinDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Protein dataset.</p>
<p>Each sample contains a protein graph, and any number of prediction targets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ProteinDataset.load_fasta">
<span class="sig-name descname"><span class="pre">load_fasta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fasta_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinDataset.load_fasta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinDataset.load_fasta" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from a fasta file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fasta_file</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>attributes</strong> (<em>dict of list</em>) – protein-level attributes</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – protein sequence transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the proteins are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ProteinDataset.load_lmdbs">
<span class="sig-name descname"><span class="pre">load_lmdbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmdb_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'primary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'num_examples'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinDataset.load_lmdbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinDataset.load_lmdbs" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from lmdb files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lmdb_files</strong> (<em>list of str</em>) – list of lmdb files</p></li>
<li><p><strong>sequence_field</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the field of protein sequence in lmdb files</p></li>
<li><p><strong>target_fields</strong> (<em>list of str</em><em>, </em><em>optional</em>) – name of target fields in lmdb files</p></li>
<li><p><strong>number_field</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the field of sample count in lmdb files</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – protein sequence transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the proteins are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>attributes</strong> (<em>dict of list</em>) – protein-level attributes</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ProteinDataset.load_pdbs">
<span class="sig-name descname"><span class="pre">load_pdbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinDataset.load_pdbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinDataset.load_pdbs" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from pdb files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdb_files</strong> (<em>list of str</em>) – pdb file names</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – protein sequence transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the proteins are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ProteinDataset.load_pickle">
<span class="sig-name descname"><span class="pre">load_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pkl_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinDataset.load_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinDataset.load_pickle" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pkl_file</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – protein sequence transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the proteins are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ProteinDataset.load_sequence">
<span class="sig-name descname"><span class="pre">load_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinDataset.load_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinDataset.load_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from protein sequences and targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequences</strong> (<em>list of str</em>) – protein sequence strings</p></li>
<li><p><strong>targets</strong> (<em>dict of list</em>) – prediction targets</p></li>
<li><p><strong>attributes</strong> (<em>dict of list</em>) – protein-level attributes</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – protein sequence transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the proteins are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ProteinDataset.save_pickle">
<span class="sig-name descname"><span class="pre">save_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pkl_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinDataset.save_pickle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinDataset.save_pickle" title="Permalink to this definition">#</a></dt>
<dd><p>Save the dataset to a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pkl_file</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ProteinDataset.residue_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">residue_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.ProteinDataset.residue_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of residue features.</p>
</dd></dl>
</dd></dl>
</section>
<section id="proteinpairdataset">
<h3>ProteinPairDataset<a class="headerlink" href="#proteinpairdataset" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.ProteinPairDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ProteinPairDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinPairDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinPairDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Protein pair dataset.</p>
<p>Each sample contains two protein graphs, and any number of prediction targets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ProteinPairDataset.load_lmdbs">
<span class="sig-name descname"><span class="pre">load_lmdbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmdb_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'primary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'num_examples'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinPairDataset.load_lmdbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinPairDataset.load_lmdbs" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from lmdb files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lmdb_files</strong> (<em>list of str</em>) – file names</p></li>
<li><p><strong>sequence_field</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – names of the fields of protein sequence in lmdb files</p></li>
<li><p><strong>target_fields</strong> (<em>list of str</em><em>, </em><em>optional</em>) – name of target fields in lmdb files</p></li>
<li><p><strong>number_field</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the field of sample count in lmdb files</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – protein sequence transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the protein pairs are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>attributes</strong> (<em>dict of list</em>) – protein-level attributes</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ProteinPairDataset.load_sequence">
<span class="sig-name descname"><span class="pre">load_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinPairDataset.load_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinPairDataset.load_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from protein sequences and targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequences</strong> (<em>list of list of str</em>) – protein sequence string pairs</p></li>
<li><p><strong>targets</strong> (<em>dict of list</em>) – prediction targets</p></li>
<li><p><strong>attributes</strong> (<em>dict of list</em>) – protein-level attributes</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – protein sequence transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the protein pairs are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ProteinPairDataset.node_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">node_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.ProteinPairDataset.node_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of node features.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ProteinPairDataset.residue_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">residue_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.ProteinPairDataset.residue_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of residue features.</p>
</dd></dl>
</dd></dl>
</section>
<section id="proteinliganddataset">
<h3>ProteinLigandDataset<a class="headerlink" href="#proteinliganddataset" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.ProteinLigandDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ProteinLigandDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinLigandDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinLigandDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Protein-ligand dataset.</p>
<p>Each sample contains a protein graph and a molecule graph, and any number of prediction targets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ProteinLigandDataset.load_lmdbs">
<span class="sig-name descname"><span class="pre">load_lmdbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lmdb_files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'drug'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'num_examples'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinLigandDataset.load_lmdbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinLigandDataset.load_lmdbs" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from lmdb files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lmdb_files</strong> (<em>list of str</em>) – file names</p></li>
<li><p><strong>sequence_field</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the field of protein sequence in lmdb files</p></li>
<li><p><strong>smiles_field</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the field of ligand SMILES string in lmdb files</p></li>
<li><p><strong>target_fields</strong> (<em>list of str</em><em>, </em><em>optional</em>) – name of target fields in lmdb files</p></li>
<li><p><strong>number_field</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the field of sample count in lmdb files</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – protein sequence transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the protein-ligand pairs are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>attributes</strong> (<em>dict of list</em>) – protein-level attributes</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ProteinLigandDataset.load_sequence">
<span class="sig-name descname"><span class="pre">load_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residue_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ProteinLigandDataset.load_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ProteinLigandDataset.load_sequence" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from protein sequences, ligand SMILES strings and targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequences</strong> (<em>list of str</em>) – protein sequence strings</p></li>
<li><p><strong>smiles</strong> (<em>list of str</em>) – ligand SMILES strings</p></li>
<li><p><strong>targets</strong> (<em>dict of list</em>) – prediction targets</p></li>
<li><p><strong>num_samples</strong> (<em>list of int</em>) – numbers of protein-ligand pairs in all splits</p></li>
<li><p><strong>attributes</strong> (<em>dict of list</em>) – protein-level attributes</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – protein sequence transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the protein-ligand pairs are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>residue_feature</strong> (<em>str</em><em>, </em><em>list of str</em><em>, </em><em>optional</em>) – residue features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ProteinLigandDataset.ligand_node_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ligand_node_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.ProteinLigandDataset.ligand_node_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of node features for ligands.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ProteinLigandDataset.protein_node_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">protein_node_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.ProteinLigandDataset.protein_node_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of node features for proteins.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ProteinLigandDataset.residue_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">residue_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.ProteinLigandDataset.residue_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of residue features for proteins.</p>
</dd></dl>
</dd></dl>
</section>
<section id="nodeclassificationdataset">
<h3>NodeClassificationDataset<a class="headerlink" href="#nodeclassificationdataset" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.NodeClassificationDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">NodeClassificationDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#NodeClassificationDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.NodeClassificationDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Node classification dataset.</p>
<p>The whole dataset contains one graph, where each node has its own node feature and label.</p>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.NodeClassificationDataset.load_tsv">
<span class="sig-name descname"><span class="pre">load_tsv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#NodeClassificationDataset.load_tsv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.NodeClassificationDataset.load_tsv" title="Permalink to this definition">#</a></dt>
<dd><p>Load the edge list from a tsv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_file</strong> (<em>str</em>) – node feature and label file</p></li>
<li><p><strong>edge_file</strong> (<em>str</em>) – edge list file</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.NodeClassificationDataset.node_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">node_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.NodeClassificationDataset.node_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of node features.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.NodeClassificationDataset.num_edge">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_edge</span></span><a class="headerlink" href="#torchdrug.data.NodeClassificationDataset.num_edge" title="Permalink to this definition">#</a></dt>
<dd><p>Number of edges.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.NodeClassificationDataset.num_node">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_node</span></span><a class="headerlink" href="#torchdrug.data.NodeClassificationDataset.num_node" title="Permalink to this definition">#</a></dt>
<dd><p>Number of nodes.</p>
</dd></dl>
</dd></dl>
</section>
<section id="reactiondataset">
<h3>ReactionDataset<a class="headerlink" href="#reactiondataset" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.ReactionDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ReactionDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ReactionDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ReactionDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Chemical reaction dataset.</p>
<p>Each sample contains two molecule graphs, and any number of prediction targets.</p>
<dl class="py method">
<dt class="sig sig-object py" id="torchdrug.data.ReactionDataset.load_smiles">
<span class="sig-name descname"><span class="pre">load_smiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_hydrogen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kekulize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ReactionDataset.load_smiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ReactionDataset.load_smiles" title="Permalink to this definition">#</a></dt>
<dd><p>Load the dataset from SMILES and targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_list</strong> (<em>list of str</em>) – SMILES strings</p></li>
<li><p><strong>targets</strong> (<em>dict of list</em>) – prediction targets</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – data transformation function</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>atom_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – atom features to extract</p></li>
<li><p><strong>bond_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – bond features to extract</p></li>
<li><p><strong>mol_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – molecule features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">atom_feature</span></code></p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">bond_feature</span></code></p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – Deprecated alias of <code class="docutils literal notranslate"><span class="pre">mol_feature</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ReactionDataset.atom_types">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_types</span></span><a class="headerlink" href="#torchdrug.data.ReactionDataset.atom_types" title="Permalink to this definition">#</a></dt>
<dd><p>All atom types.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ReactionDataset.bond_types">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bond_types</span></span><a class="headerlink" href="#torchdrug.data.ReactionDataset.bond_types" title="Permalink to this definition">#</a></dt>
<dd><p>All bond types.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ReactionDataset.edge_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edge_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.ReactionDataset.edge_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of edge features.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ReactionDataset.node_feature_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">node_feature_dim</span></span><a class="headerlink" href="#torchdrug.data.ReactionDataset.node_feature_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Dimension of node features.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ReactionDataset.num_atom_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_atom_type</span></span><a class="headerlink" href="#torchdrug.data.ReactionDataset.num_atom_type" title="Permalink to this definition">#</a></dt>
<dd><p>Number of different atom types.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="torchdrug.data.ReactionDataset.num_bond_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_bond_type</span></span><a class="headerlink" href="#torchdrug.data.ReactionDataset.num_bond_type" title="Permalink to this definition">#</a></dt>
<dd><p>Number of different bond types.</p>
</dd></dl>
</dd></dl>
</section>
<section id="semisupervised">
<h3>SemiSupervised<a class="headerlink" href="#semisupervised" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.SemiSupervised">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SemiSupervised</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#SemiSupervised"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.SemiSupervised" title="Permalink to this definition">#</a></dt>
<dd><p>Semi-supervised dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – supervised dataset</p></li>
<li><p><strong>indices</strong> (<em>list of int</em>) – sample indices to keep supervision</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</section>
</section>
<section id="data-processing">
<h2>Data Processing<a class="headerlink" href="#data-processing" title="Permalink to this headline">#</a></h2>
<section id="dataloader">
<h3>DataLoader<a class="headerlink" href="#dataloader" title="Permalink to this headline">#</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="torchdrug.data.DataLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DataLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn=&lt;function</span> <span class="pre">graph_collate&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataloader.html#DataLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.DataLoader" title="Permalink to this definition">#</a></dt>
<dd><p>Extended data loader for batching graph structured data.</p>
<p>See <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader">torch.utils.data.DataLoader</a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – dataset from which to load the data</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – how many samples per batch to load</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to have the data reshuffled at every epoch</p></li>
<li><p><strong>sampler</strong> (<em>Sampler</em><em>, </em><em>optional</em>) – sampler that draws single sample from the dataset</p></li>
<li><p><strong>batch_sampler</strong> (<em>Sampler</em><em>, </em><em>optional</em>) – sampler that draws a mini-batch of data from the dataset</p></li>
<li><p><strong>num_workers</strong> (<em>int</em><em>, </em><em>optional</em>) – how many subprocesses to use for data loading</p></li>
<li><p><strong>collate_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – merge a list of samples into a mini-batch</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader">torch.utils.data.DataLoader</a></p></li>
</ul>
</dd>
</dl>
</dd></dl>
</section>
<section id="dataset-split-methods">
<h3>Dataset Split Methods<a class="headerlink" href="#dataset-split-methods" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.graph_collate">
<span class="sig-name descname"><span class="pre">graph_collate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataloader.html#graph_collate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.graph_collate" title="Permalink to this definition">#</a></dt>
<dd><p>Convert any list of same nested container into a container of tensors.</p>
<p>For instances of <a class="reference internal" href="#torchdrug.data.Graph" title="torchdrug.data.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">data.Graph</span></code></a>, they are collated
by <a class="reference internal" href="#torchdrug.data.Graph.pack" title="torchdrug.data.Graph.pack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">data.Graph.pack</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>list</em>) – list of samples with the same nested container</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.key_split">
<span class="sig-name descname"><span class="pre">key_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_lengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#key_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.key_split" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.ordered_scaffold_split">
<span class="sig-name descname"><span class="pre">ordered_scaffold_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chirality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ordered_scaffold_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.ordered_scaffold_split" title="Permalink to this definition">#</a></dt>
<dd><p>Split a dataset into new datasets with non-overlapping scaffolds and sorted w.r.t. number of each scaffold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – dataset to split</p></li>
<li><p><strong>lengths</strong> (<em>list of int</em>) – expected length for each split.
Note the results may be different in length due to rounding.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.scaffold_split">
<span class="sig-name descname"><span class="pre">scaffold_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#scaffold_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.scaffold_split" title="Permalink to this definition">#</a></dt>
<dd><p>Randomly split a dataset into new datasets with non-overlapping scaffolds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – dataset to split</p></li>
<li><p><strong>lengths</strong> (<em>list of int</em>) – expected length for each split.
Note the results may be different in length due to rounding.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.semisupervised">
<span class="sig-name descname"><span class="pre">semisupervised</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#semisupervised"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.semisupervised" title="Permalink to this definition">#</a></dt>
<dd><p>Randomly construct a semi-supervised dataset based on the given length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – supervised dataset</p></li>
<li><p><strong>length</strong> (<em>int</em>) – length of supervised data to keep</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</section>
</section>
<section id="feature-functions">
<h2>Feature Functions<a class="headerlink" href="#feature-functions" title="Permalink to this headline">#</a></h2>
<section id="atom-features">
<h3>Atom Features<a class="headerlink" href="#atom-features" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.atom_default">
<span class="sig-name descname"><span class="pre">atom_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_default"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.atom_default" title="Permalink to this definition">#</a></dt>
<dd><p>Default atom feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetChiralTag(): one-hot embedding for atomic chiral tag</p>
<p>GetTotalDegree(): one-hot embedding for the degree of the atom in the molecule including Hs</p>
<p>GetFormalCharge(): one-hot embedding for the number of formal charges in the molecule</p>
<p>GetTotalNumHs(): one-hot embedding for the total number of Hs (explicit and implicit) on the atom</p>
<p>GetNumRadicalElectrons(): one-hot embedding for the number of radical electrons on the atom</p>
<p>GetHybridization(): one-hot embedding for the atom’s hybridization</p>
<p>GetIsAromatic(): whether the atom is aromatic</p>
<p>IsInRing(): whether the atom is in a ring</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.atom_symbol">
<span class="sig-name descname"><span class="pre">atom_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.atom_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>Symbol atom feature.</p>
<dl class="simple">
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.atom_position">
<span class="sig-name descname"><span class="pre">atom_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.atom_position" title="Permalink to this definition">#</a></dt>
<dd><p>Atom position in the molecular conformation.
Return 3D position if available, otherwise 2D position is returned.</p>
<p>Note it takes much time to compute the conformation for large molecules.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.atom_property_prediction">
<span class="sig-name descname"><span class="pre">atom_property_prediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_property_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.atom_property_prediction" title="Permalink to this definition">#</a></dt>
<dd><p>Property prediction atom feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetDegree(): one-hot embedding for the degree of the atom in the molecule</p>
<p>GetTotalNumHs(): one-hot embedding for the total number of Hs (explicit and implicit) on the atom</p>
<p>GetTotalValence(): one-hot embedding for the total valence (explicit + implicit) of the atom</p>
<p>GetFormalCharge(): one-hot embedding for the number of formal charges in the molecule</p>
<p>GetIsAromatic(): whether the atom is aromatic</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.atom_explicit_property_prediction">
<span class="sig-name descname"><span class="pre">atom_explicit_property_prediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_explicit_property_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.atom_explicit_property_prediction" title="Permalink to this definition">#</a></dt>
<dd><p>Explicit property prediction atom feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetDegree(): one-hot embedding for the degree of the atom in the molecule</p>
<p>GetTotalValence(): one-hot embedding for the total valence (explicit + implicit) of the atom</p>
<p>GetFormalCharge(): one-hot embedding for the number of formal charges in the molecule</p>
<p>GetIsAromatic(): whether the atom is aromatic</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.atom_pretrain">
<span class="sig-name descname"><span class="pre">atom_pretrain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_pretrain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.atom_pretrain" title="Permalink to this definition">#</a></dt>
<dd><p>Atom feature for pretraining.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetChiralTag(): one-hot embedding for atomic chiral tag</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.atom_center_identification">
<span class="sig-name descname"><span class="pre">atom_center_identification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_center_identification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.atom_center_identification" title="Permalink to this definition">#</a></dt>
<dd><p>Reaction center identification atom feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetTotalNumHs(): one-hot embedding for the total number of Hs (explicit and implicit) on the atom</p>
<p>GetTotalDegree(): one-hot embedding for the degree of the atom in the molecule including Hs</p>
<p>GetTotalValence(): one-hot embedding for the total valence (explicit + implicit) of the atom</p>
<p>GetIsAromatic(): whether the atom is aromatic</p>
<p>IsInRing(): whether the atom is in a ring</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.atom_synthon_completion">
<span class="sig-name descname"><span class="pre">atom_synthon_completion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_synthon_completion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.atom_synthon_completion" title="Permalink to this definition">#</a></dt>
<dd><p>Synthon completion atom feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetTotalNumHs(): one-hot embedding for the total number of Hs (explicit and implicit) on the atom</p>
<p>GetTotalDegree(): one-hot embedding for the degree of the atom in the molecule including Hs</p>
<p>IsInRing(): whether the atom is in a ring</p>
<p>IsInRingSize(3, 4, 5, 6): whether the atom is in a ring of a particular size</p>
<p>IsInRing() and not IsInRingSize(3, 4, 5, 6): whether the atom is in a ring and not in a ring of 3, 4, 5, 6</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.atom_residue_symbol">
<span class="sig-name descname"><span class="pre">atom_residue_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_residue_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.atom_residue_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>Residue symbol as atom feature. Only support atoms in a protein.</p>
<dl class="simple">
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol
GetResidueName(): one-hot embedding for the residue symbol</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="bond-features">
<h3>Bond Features<a class="headerlink" href="#bond-features" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.bond_default">
<span class="sig-name descname"><span class="pre">bond_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#bond_default"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.bond_default" title="Permalink to this definition">#</a></dt>
<dd><p>Default bond feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetBondType(): one-hot embedding for the type of the bond</p>
<p>GetBondDir(): one-hot embedding for the direction of the bond</p>
<p>GetStereo(): one-hot embedding for the stereo configuration of the bond</p>
<p>GetIsConjugated(): whether the bond is considered to be conjugated</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.bond_length">
<span class="sig-name descname"><span class="pre">bond_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#bond_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.bond_length" title="Permalink to this definition">#</a></dt>
<dd><p>Bond length in the molecular conformation.</p>
<p>Note it takes much time to compute the conformation for large molecules.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.bond_property_prediction">
<span class="sig-name descname"><span class="pre">bond_property_prediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#bond_property_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.bond_property_prediction" title="Permalink to this definition">#</a></dt>
<dd><p>Property prediction bond feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetBondType(): one-hot embedding for the type of the bond</p>
<p>GetIsConjugated(): whether the bond is considered to be conjugated</p>
<p>IsInRing(): whether the bond is in a ring</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.bond_pretrain">
<span class="sig-name descname"><span class="pre">bond_pretrain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#bond_pretrain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.bond_pretrain" title="Permalink to this definition">#</a></dt>
<dd><p>Bond feature for pretraining.</p>
<dl>
<dt>Features:</dt><dd><p>GetBondType(): one-hot embedding for the type of the bond</p>
<p>GetBondDir(): one-hot embedding for the direction of the bond</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="residue-features">
<h3>Residue Features<a class="headerlink" href="#residue-features" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.residue_default">
<span class="sig-name descname"><span class="pre">residue_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#residue_default"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.residue_default" title="Permalink to this definition">#</a></dt>
<dd><p>Default residue feature.</p>
<dl class="simple">
<dt>Features:</dt><dd><p>GetResidueName(): one-hot embedding for the residue symbol</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.residue_symbol">
<span class="sig-name descname"><span class="pre">residue_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#residue_symbol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.residue_symbol" title="Permalink to this definition">#</a></dt>
<dd><p>Symbol residue feature.</p>
<dl class="simple">
<dt>Features:</dt><dd><p>GetResidueName(): one-hot embedding for the residue symbol</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="molecule-features">
<h3>Molecule Features<a class="headerlink" href="#molecule-features" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.molecule_default">
<span class="sig-name descname"><span class="pre">molecule_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#molecule_default"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.molecule_default" title="Permalink to this definition">#</a></dt>
<dd><p>Default molecule feature.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.ExtendedConnectivityFingerprint">
<span class="sig-name descname"><span class="pre">ExtendedConnectivityFingerprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#ExtendedConnectivityFingerprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchdrug.data.feature.ExtendedConnectivityFingerprint" title="Permalink to this definition">#</a></dt>
<dd><p>Extended Connectivity Fingerprint molecule feature.</p>
<dl class="simple">
<dt>Features:</dt><dd><p>GetMorganFingerprintAsBitVect(): a Morgan fingerprint for a molecule as a bit vector</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="torchdrug.data.feature.ECFP">
<span class="sig-name descname"><span class="pre">ECFP</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#torchdrug.data.feature.ECFP" title="Permalink to this definition">#</a></dt>
<dd><p>alias of <code class="docutils literal notranslate"><span class="pre">torchdrug.data.feature.ExtendedConnectivityFingerprint</span></code></p>
</dd></dl>
</section>
</section>
<section id="element-constants">
<h2>Element Constants<a class="headerlink" href="#element-constants" title="Permalink to this headline">#</a></h2>
<p>Element constants are provided for convenient manipulation of atom types. The atomic
numbers can be accessed by uppercased element names at the root of the package. For
example, we can get the carbon scaffold of a molecule with the following code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torchdrug</span> <span class="k">as</span> <span class="nn">td</span>
<span class="kn">from</span> <span class="nn">torchdrug</span> <span class="kn">import</span> <span class="n">data</span>

<span class="n">smiles</span> <span class="o">=</span> <span class="s2">"CC1=C(C=C(C=C1[N+](=O)[O-])[N+](=O)[O-])[N+](=O)[O-]"</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">scaffold</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">atom_type</span> <span class="o">==</span> <span class="n">td</span><span class="o">.</span><span class="n">CARBON</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="n">scaffold</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tnt.png"><img alt="../_images/tnt.png" src="../_images/tnt.png" style="width: 33%;"/></a>
<a class="reference internal image-reference" href="../_images/tnt_carbon_scaffold.png"><img alt="../_images/tnt_carbon_scaffold.png" src="../_images/tnt_carbon_scaffold.png" style="width: 33%;"/></a>
<p>There are also 2 constant arrays that map atomic numbers to element names.
<code class="docutils literal notranslate"><span class="pre">td.ATOM_NAME[i]</span></code> returns the full name, while <code class="docutils literal notranslate"><span class="pre">td.ATOM_SYMBOL[i]</span></code> returns the
abbreviated chemical symbol for atomic number <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p>
<p>For a full list of elements, please refer to <a class="reference external" href="https://en.wikipedia.org/wiki/Periodic_table">the perodic table</a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="datasets.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">torchdrug.datasets</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="core.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">torchdrug.core</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021, MilaGraph Group
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">torchdrug.data</a><ul>
<li><a class="reference internal" href="#data-structures">Data Structures</a><ul>
<li><a class="reference internal" href="#graph">Graph</a></li>
<li><a class="reference internal" href="#molecule">Molecule</a></li>
<li><a class="reference internal" href="#protein">Protein</a></li>
<li><a class="reference internal" href="#packedgraph">PackedGraph</a></li>
<li><a class="reference internal" href="#packedmolecule">PackedMolecule</a></li>
<li><a class="reference internal" href="#packedprotein">PackedProtein</a></li>
<li><a class="reference internal" href="#dictionary">Dictionary</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datasets">Datasets</a><ul>
<li><a class="reference internal" href="#knowledgegraphdataset">KnowledgeGraphDataset</a></li>
<li><a class="reference internal" href="#moleculedataset">MoleculeDataset</a></li>
<li><a class="reference internal" href="#proteindataset">ProteinDataset</a></li>
<li><a class="reference internal" href="#proteinpairdataset">ProteinPairDataset</a></li>
<li><a class="reference internal" href="#proteinliganddataset">ProteinLigandDataset</a></li>
<li><a class="reference internal" href="#nodeclassificationdataset">NodeClassificationDataset</a></li>
<li><a class="reference internal" href="#reactiondataset">ReactionDataset</a></li>
<li><a class="reference internal" href="#semisupervised">SemiSupervised</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-processing">Data Processing</a><ul>
<li><a class="reference internal" href="#dataloader">DataLoader</a></li>
<li><a class="reference internal" href="#dataset-split-methods">Dataset Split Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#feature-functions">Feature Functions</a><ul>
<li><a class="reference internal" href="#atom-features">Atom Features</a></li>
<li><a class="reference internal" href="#bond-features">Bond Features</a></li>
<li><a class="reference internal" href="#residue-features">Residue Features</a></li>
<li><a class="reference internal" href="#molecule-features">Molecule Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#element-constants">Element Constants</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>