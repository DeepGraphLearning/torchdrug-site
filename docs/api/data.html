<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="torchdrug.datasets" href="datasets.html" /><link rel="prev" title="torchdrug.core" href="core.html" />

    <meta name="generator" content="sphinx-3.1.2, furo 2020.12.09.beta21"/>
        <title>torchdrug.data - TorchDrug 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/styles/furo.css?digest=a3f371badb8538d75df213ccffb17a4f6e8f3ac5">
    <link rel="stylesheet" href="../_static/pygments.css">
    <link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../_static/pygments_dark.css">
    


<style>
  :root {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --font-stack: Helvetica, Arial, sans-serif, -apple-system;
  --font-stack--monospace: Courier, monospace;
  --color-brand-primary: #E5261F;
  --color-brand-content: #E5261F;
  --admonition-font-size: 1rem;
  --admonition-title-font-size: 1rem;
  --font-size--small--2: var(--font-size--small);
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --font-stack: Helvetica, Arial, sans-serif, -apple-system;
  --font-stack--monospace: Courier, monospace;
  --color-brand-primary: #E5261F;
  --color-brand-content: #E5261F;
  --admonition-font-size: 1rem;
  --admonition-title-font-size: 1rem;
  --font-size--small--2: var(--font-size--small);
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css" />
    <link rel="stylesheet" href="../_static/styles/furo-extensions.css?digest=26485485040e7aaf717c13fd0188a5ad2c2deb60">
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script defer src="../_static/jquery.js"></script>
    <script defer src="../_static/underscore.js"></script>
    <script defer src="../_static/doctools.js"></script>
    <script defer src="../_static/language_data.js"></script>
    <script defer async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script defer src="../_static/scripts/main.js?digest=e931d09b2a40c1bb82b542effe772014573baf67"></script></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>


<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">TorchDrug 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html">
  <input class="sidebar-search" placeholder="Search" name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../benchmark/index.html">Benchmark</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/property_prediction.html">Molecule Property Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/pretrain.html">Pretrained Molecular Representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/generation.html">Molecule Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/retrosynthesis.html">Retrosynthesis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark/reasoning.html">Knowledge Graph Reasoning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/property_prediction.html">Property Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/pretrain.html">Pretrained Molecular Representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/generation.html">Molecule Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/retrosynthesis.html">Retrosynthesis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/reasoning.html">Knowledge Graph Reasoning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notes/index.html">Notes</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/graph.html">Graph Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/variadic.html">Batch Irregular Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/layer.html">Graph Neural Network Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/model.html">Customize Models &amp; Tasks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../paper.html">Papers Implemented</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Documentation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="core.html">torchdrug.core</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">torchdrug.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html">torchdrug.datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="transforms.html">torchdrug.transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">torchdrug.metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="layers.html">torchdrug.layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">torchdrug.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html">torchdrug.tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">torchdrug.utils</a></li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="torchdrug-data">
<h1>torchdrug.data<a class="headerlink" href="#torchdrug-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="data-structures">
<h2>Data Structures<a class="headerlink" href="#data-structures" title="Permalink to this headline">¶</a></h2>
<div class="section" id="graph">
<h3>Graph<a class="headerlink" href="#graph" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="torchdrug.data.Graph">
<em class="property">class </em><code class="sig-name descname">Graph</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edge_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">edge_weight</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_node</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_relation</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">node_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">edge_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">graph_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic container for sparse graphs.</p>
<p>To batch graphs with variadic sizes, use <a class="reference internal" href="#torchdrug.data.Graph.pack" title="torchdrug.data.Graph.pack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">data.Graph.pack</span></code></a>.
This will return a PackedGraph object with the following block diagonal adjacency matrix.</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
    A_1    &amp; \cdots &amp; 0      \\
    \vdots &amp; \ddots &amp; \vdots \\
    0      &amp; \cdots &amp; A_n
\end{bmatrix}\end{split}\]</div></div>
<p>where <span class="math notranslate nohighlight">\(A_i\)</span> is the adjacency of <span class="math notranslate nohighlight">\(i\)</span>-th graph.</p>
<p>You may register dynamic attributes for each graph.
The registered attributes will be automatically processed during packing.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">graph</span><span class="o">.</span><span class="n">my_node_attr</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – list of edges of shape <span class="math notranslate nohighlight">\((|E|, 2)\)</span> or <span class="math notranslate nohighlight">\((|E|, 3)\)</span>.
Each tuple is (node_in, node_out) or (node_in, node_out, relation).</p></li>
<li><p><strong>edge_weight</strong> (<em>array_like</em><em>, </em><em>optional</em>) – edge weights of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>num_node</strong> (<em>int</em><em>, </em><em>optional</em>) – number of nodes.
By default, it will be inferred from the largest id in <cite>edge_list</cite></p></li>
<li><p><strong>num_relation</strong> (<em>int</em><em>, </em><em>optional</em>) – number of relations</p></li>
<li><p><strong>node_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – node features of shape <span class="math notranslate nohighlight">\((|V|, ...)\)</span></p></li>
<li><p><strong>edge_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – edge features of shape <span class="math notranslate nohighlight">\((|E|, ...)\)</span></p></li>
<li><p><strong>graph_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – graph feature of any shape</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="torchdrug.data.Graph.packed_type">
<code class="sig-name descname">packed_type</code><a class="headerlink" href="#torchdrug.data.Graph.packed_type" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#torchdrug.data.PackedGraph" title="torchdrug.data.PackedGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">PackedGraph</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.clone">
<code class="sig-name descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.clone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Clone this graph.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.compact">
<code class="sig-name descname">compact</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.compact"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.compact" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove isolated nodes and compact node ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.connected_components">
<code class="sig-name descname">connected_components</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.connected_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.connected_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Split this graph into connected components.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>connected components, number of connected components per graph</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(<a class="reference internal" href="#torchdrug.data.PackedGraph" title="torchdrug.data.PackedGraph">PackedGraph</a>, Tensor)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.copy_">
<code class="sig-name descname">copy_</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">src</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.copy_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.copy_" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy data from <code class="docutils literal notranslate"><span class="pre">src</span></code> into <code class="docutils literal notranslate"><span class="pre">self</span></code> and return <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">src</span></code> graph must have the same shape and the same set of attributes as <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.cpu">
<code class="sig-name descname">cpu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.cpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.cpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of this graph in CPU memory.</p>
<p>This is a non-op if the graph is already in CPU memory.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.cuda">
<code class="sig-name descname">cuda</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.cuda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.cuda" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of this graph in CUDA memory.</p>
<p>This is a non-op if the graph is already on the correct device.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.detach">
<code class="sig-name descname">detach</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.detach"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.detach" title="Permalink to this definition">¶</a></dt>
<dd><p>Detach this graph.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.directed">
<code class="sig-name descname">directed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.directed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.directed" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask the edges to create a directed graph.
Edges that go from a node index to a larger or equal node index will be kept.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>order</strong> (<em>Tensor</em><em>, </em><em>optional</em>) – topological order of the nodes</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.edge">
<code class="sig-name descname">edge</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager for edge attributes.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.edge_mask">
<code class="sig-name descname">edge_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.edge_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.edge_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a masked graph based on the specified edges.</p>
<p>This function can also be used to re-order the edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – edge index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.from_dense">
<em class="property">classmethod </em><code class="sig-name descname">from_dense</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">adjacency</span></em>, <em class="sig-param"><span class="n">node_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">edge_feature</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.from_dense"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.from_dense" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a sparse graph from a dense adjacency matrix.
For zero entries in the adjacency matrix, their edge features will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adjacency</strong> (<em>array_like</em>) – adjacency matrix of shape <span class="math notranslate nohighlight">\((|V|, |V|)\)</span> or <span class="math notranslate nohighlight">\((|V|, |V|, |R|)\)</span></p></li>
<li><p><strong>node_feature</strong> (<em>array_like</em>) – node features of shape <span class="math notranslate nohighlight">\((|V|, ...)\)</span></p></li>
<li><p><strong>edge_feature</strong> (<em>array_like</em>) – edge features of shape <span class="math notranslate nohighlight">\((|V|, |V|, ...)\)</span> or <span class="math notranslate nohighlight">\((|V|, |V|, |R|, ...)\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.full">
<code class="sig-name descname">full</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.full" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a fully connected graph over the nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.get_edge">
<code class="sig-name descname">get_edge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edge</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.get_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.get_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the weight of of an edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> (<em>array_like</em>) – index of shape <span class="math notranslate nohighlight">\((2,)\)</span> or <span class="math notranslate nohighlight">\((3,)\)</span></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weight of the edge</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.graph">
<code class="sig-name descname">graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager for graph attributes.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.index">
<code class="sig-name descname">index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edge</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all indexes of the edge. Support partial match with wildcard <cite>None</cite>.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Graph</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">==</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>edge</strong> (<em>array_like</em>) – queried edge</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>indexes of the edge</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.node">
<code class="sig-name descname">node</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.node"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.node" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager for node attributes.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.node_mask">
<code class="sig-name descname">node_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="n">compact</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.node_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.node_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a masked graph based on the specified nodes.</p>
<p>This function can also be used to re-order the nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – node index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact node ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">node_mask</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">adjacency</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">node_mask</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.pack">
<em class="property">classmethod </em><code class="sig-name descname">pack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">graphs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.pack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack a list of graphs into a PackedGraph object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>graphs</strong> (<em>list of Graph</em>) – list of graphs</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.repeat">
<code class="sig-name descname">repeat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">count</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.repeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.repeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeat this graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>count</strong> (<em>int</em>) – number of repetitions</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.split">
<code class="sig-name descname">split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node2graph</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a graph into multiple disconnected graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>node2graph</strong> (<em>array_like</em>) – ID of the graph each node belongs to</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.subgraph">
<code class="sig-name descname">subgraph</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.subgraph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.subgraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a subgraph based on the specified nodes.
Equivalent to <a class="reference internal" href="#torchdrug.data.Graph.node_mask" title="torchdrug.data.Graph.node_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">node_mask(index,</span> <span class="pre">compact=True)</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – node index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#torchdrug.data.Graph.node_mask" title="torchdrug.data.Graph.node_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Graph.node_mask()</span></code></a></p>
</div>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.undirected">
<code class="sig-name descname">undirected</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">add_inverse</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.undirected"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.undirected" title="Permalink to this definition">¶</a></dt>
<dd><p>Flip all the edges to create an undirected graph.</p>
<p>For knowledge graphs, the flipped edges can either have the original relation or an inverse relation.
The inverse relation for relation <span class="math notranslate nohighlight">\(r\)</span> is defined as <span class="math notranslate nohighlight">\(|R| + r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>add_inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to use inverse relations for flipped edges</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.visualize">
<code class="sig-name descname">visualize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figure_size</span><span class="o">=</span><span class="default_value">3, 3</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'spring'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#Graph.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Graph.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize this graph with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – title for this graph</p></li>
<li><p><strong>save_file</strong> (<em>str</em><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">png</span></code> or <code class="docutils literal notranslate"><span class="pre">pdf</span></code> file to save visualization.
If not provided, show the figure in window.</p></li>
<li><p><strong>figure_size</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – width and height of the figure</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em>, </em><em>optional</em>) – axis to plot the figure</p></li>
<li><p><strong>layout</strong> (<em>str</em><em>, </em><em>optional</em>) – graph layout</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/reference/drawing.html#module-networkx.drawing.layout">NetworkX graph layout</a></p>
</div>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.adjacency">
<em class="property">property </em><code class="sig-name descname">adjacency</code><a class="headerlink" href="#torchdrug.data.Graph.adjacency" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjacency matrix of this graph.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">num_relation</span></code> is specified, a sparse tensor of shape <span class="math notranslate nohighlight">\((|V|, |V|, num\_relation)\)</span> will be
returned.
Otherwise, a sparse tensor of shape <span class="math notranslate nohighlight">\((|V|, |V|)\)</span> will be returned.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.batch_size">
<em class="property">property </em><code class="sig-name descname">batch_size</code><a class="headerlink" href="#torchdrug.data.Graph.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch size.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.degree_in">
<em class="property">property </em><code class="sig-name descname">degree_in</code><a class="headerlink" href="#torchdrug.data.Graph.degree_in" title="Permalink to this definition">¶</a></dt>
<dd><p>In degree of nodes.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.degree_out">
<em class="property">property </em><code class="sig-name descname">degree_out</code><a class="headerlink" href="#torchdrug.data.Graph.degree_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Out degree of nodes.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#torchdrug.data.Graph.device" title="Permalink to this definition">¶</a></dt>
<dd><p>Device.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.edge2graph">
<em class="property">property </em><code class="sig-name descname">edge2graph</code><a class="headerlink" href="#torchdrug.data.Graph.edge2graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Edge id to graph id mapping.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.edge_list">
<em class="property">property </em><code class="sig-name descname">edge_list</code><a class="headerlink" href="#torchdrug.data.Graph.edge_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List of edges.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.edge_weight">
<em class="property">property </em><code class="sig-name descname">edge_weight</code><a class="headerlink" href="#torchdrug.data.Graph.edge_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Edge weights.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Graph.node2graph">
<em class="property">property </em><code class="sig-name descname">node2graph</code><a class="headerlink" href="#torchdrug.data.Graph.node2graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Node id to graph id mapping.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="molecule">
<h3>Molecule<a class="headerlink" href="#molecule" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="torchdrug.data.Molecule">
<em class="property">class </em><code class="sig-name descname">Molecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edge_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">atom_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bond_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">formal_charge</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">explicit_hs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chiral_tag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">radical_electrons</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">atom_map</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bond_stereo</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">stereo_atoms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Molecule graph with chemical features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – list of edges of shape <span class="math notranslate nohighlight">\((|E|, 3)\)</span>.
Each tuple is (node_in, node_out, bond_type).</p></li>
<li><p><strong>atom_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – atom types of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>bond_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – bond types of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>formal_charge</strong> (<em>array_like</em><em>, </em><em>optional</em>) – formal charges of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>explicit_hs</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of explicit hydrogens of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>chiral_tag</strong> (<em>array_like</em><em>, </em><em>optional</em>) – chirality tags of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>radical_electrons</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of radical electrons of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>atom_map</strong> (<em>array_likeb optional</em>) – atom mappings of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>bond_stereo</strong> (<em>array_like</em><em>, </em><em>optional</em>) – bond stereochem of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>stereo_atoms</strong> (<em>array_like</em><em>, </em><em>optional</em>) – ids of stereo atoms of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="torchdrug.data.Molecule.packed_type">
<code class="sig-name descname">packed_type</code><a class="headerlink" href="#torchdrug.data.Molecule.packed_type" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#torchdrug.data.PackedMolecule" title="torchdrug.data.PackedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">PackedMolecule</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.edge_mask">
<code class="sig-name descname">edge_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.edge_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule.edge_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a masked graph based on the specified edges.</p>
<p>This function can also be used to re-order the edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – edge index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.from_molecule">
<em class="property">classmethod </em><code class="sig-name descname">from_molecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span></em>, <em class="sig-param"><span class="n">node_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">edge_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">graph_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">with_hydrogen</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">kekulize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.from_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule.from_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a molecule from a RDKit object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>rdchem.Mol</em>) – molecule</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – node features to extract</p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – edge features to extract</p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – graph features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.from_smiles">
<em class="property">classmethod </em><code class="sig-name descname">from_smiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smiles</span></em>, <em class="sig-param"><span class="n">node_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">edge_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">graph_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">with_hydrogen</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">kekulize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.from_smiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule.from_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a molecule from a SMILES string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>str</em>) – SMILES string</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – node features to extract</p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – edge features to extract</p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – graph features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.ion_to_molecule">
<code class="sig-name descname">ion_to_molecule</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.ion_to_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule.ion_to_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert ions to molecules by adjusting hydrogens and electrons.</p>
<p>Note [N+] will not be converted.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.node_mask">
<code class="sig-name descname">node_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="n">compact</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.node_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule.node_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a masked graph based on the specified nodes.</p>
<p>This function can also be used to re-order the nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – node index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact node ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graph</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">from_dense</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">node_mask</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">adjacency</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">graph</span><span class="o">.</span><span class="n">node_mask</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">compact</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">adjacency</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.to_molecule">
<code class="sig-name descname">to_molecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ignore_error</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.to_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule.to_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a RDKit object of this molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ignore_error</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true, return <code class="docutils literal notranslate"><span class="pre">None</span></code> for illegal molecules.
Otherwise, raise an exception.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rdchem.Mol</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.to_scaffold">
<code class="sig-name descname">to_scaffold</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">chirality</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.to_scaffold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule.to_scaffold" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a scaffold SMILES string of this molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chirality</strong> (<em>bool</em><em>, </em><em>optional</em>) – consider chirality in the scaffold or not</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.to_smiles">
<code class="sig-name descname">to_smiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">isomeric</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">atom_map</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">canonical</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.to_smiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule.to_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a SMILES string of this molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isomeric</strong> (<em>bool</em><em>, </em><em>optional</em>) – keep isomeric information or not</p></li>
<li><p><strong>atom_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – keep atom mapping or not</p></li>
<li><p><strong>canonical</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true, return the canonical form of smiles</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.undirected">
<code class="sig-name descname">undirected</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">add_inverse</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.undirected"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule.undirected" title="Permalink to this definition">¶</a></dt>
<dd><p>Flip all the edges to create an undirected graph.</p>
<p>For knowledge graphs, the flipped edges can either have the original relation or an inverse relation.
The inverse relation for relation <span class="math notranslate nohighlight">\(r\)</span> is defined as <span class="math notranslate nohighlight">\(|R| + r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>add_inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to use inverse relations for flipped edges</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.visualize">
<code class="sig-name descname">visualize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figure_size</span><span class="o">=</span><span class="default_value">3, 3</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">atom_map</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#Molecule.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.Molecule.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize this molecule with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – title for this molecule</p></li>
<li><p><strong>save_file</strong> (<em>str</em><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">png</span></code> or <code class="docutils literal notranslate"><span class="pre">pdf</span></code> file to save visualization.
If not provided, show the figure in window.</p></li>
<li><p><strong>figure_size</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – width and height of the figure</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em>, </em><em>optional</em>) – axis to plot the figure</p></li>
<li><p><strong>atom_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – visualize atom mapping or not</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.is_valid">
<em class="property">property </em><code class="sig-name descname">is_valid</code><a class="headerlink" href="#torchdrug.data.Molecule.is_valid" title="Permalink to this definition">¶</a></dt>
<dd><p>A coarse implementation of valence check.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.num_atom">
<em class="property">property </em><code class="sig-name descname">num_atom</code><a class="headerlink" href="#torchdrug.data.Molecule.num_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.Molecule.num_bond">
<em class="property">property </em><code class="sig-name descname">num_bond</code><a class="headerlink" href="#torchdrug.data.Molecule.num_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of bonds.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="packedgraph">
<h3>PackedGraph<a class="headerlink" href="#packedgraph" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="torchdrug.data.PackedGraph">
<em class="property">class </em><code class="sig-name descname">PackedGraph</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edge_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">edge_weight</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_nodes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_edges</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_relation</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsets</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for sparse graphs with variadic sizes.</p>
<p>To create a PackedGraph from Graph objects</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">graphs</span><span class="p">)</span>
</pre></div>
</div>
<p>To retrieve Graph objects from a PackedGraph</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">graphs</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">unpack</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – list of edges of shape <span class="math notranslate nohighlight">\((|E|, 2)\)</span> or <span class="math notranslate nohighlight">\((|E|, 3)\)</span>.
Each tuple is (node_in, node_out) or (node_in, node_out, relation).</p></li>
<li><p><strong>edge_weight</strong> (<em>array_like</em><em>, </em><em>optional</em>) – edge weights of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>num_nodes</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of nodes in each graph
By default, it will be inferred from the largest id in <cite>edge_list</cite></p></li>
<li><p><strong>num_edges</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of edges in each graph</p></li>
<li><p><strong>num_relation</strong> (<em>int</em><em>, </em><em>optional</em>) – number of relations</p></li>
<li><p><strong>node_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – node features of shape <span class="math notranslate nohighlight">\((|V|, ...)\)</span></p></li>
<li><p><strong>edge_feature</strong> (<em>array_like</em><em>, </em><em>optional</em>) – edge features of shape <span class="math notranslate nohighlight">\((|E|, ...)\)</span></p></li>
<li><p><strong>offsets</strong> (<em>array_like</em><em>, </em><em>optional</em>) – node id offsets of shape <span class="math notranslate nohighlight">\((|E|,)\)</span>.
If not provided, nodes in <cite>edge_list</cite> should be relative index, i.e., the index in each graph.
If provided, nodes in <cite>edge_list</cite> should be absolute index, i.e., the index in the packed graph.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="torchdrug.data.PackedGraph.unpacked_type">
<code class="sig-name descname">unpacked_type</code><a class="headerlink" href="#torchdrug.data.PackedGraph.unpacked_type" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#torchdrug.data.Graph" title="torchdrug.data.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.clone">
<code class="sig-name descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.clone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Clone this packed graph.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.cpu">
<code class="sig-name descname">cpu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.cpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.cpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of this packed graph in CPU memory.</p>
<p>This is a non-op if the graph is already in CPU memory.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.cuda">
<code class="sig-name descname">cuda</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.cuda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.cuda" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of this packed graph in CUDA memory.</p>
<p>This is a non-op if the graph is already on the correct device.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.detach">
<code class="sig-name descname">detach</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.detach"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.detach" title="Permalink to this definition">¶</a></dt>
<dd><p>Detach this packed graph.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.edge_mask">
<code class="sig-name descname">edge_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.edge_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.edge_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a masked packed graph based on the specified edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – edge index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.full">
<code class="sig-name descname">full</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.full" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pack of fully connected graphs.</p>
<p>This is useful for computing node-pair-wise features.
The computation can be implemented as message passing over a fully connected graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.get_item">
<code class="sig-name descname">get_item</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.get_item"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.get_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the i-th graph from this packed graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) – graph index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.graph_mask">
<code class="sig-name descname">graph_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="n">compact</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.graph_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.graph_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a masked packed graph based on the specified graphs.</p>
<p>This function can also be used to re-order the graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – graph index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact graph ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.merge">
<code class="sig-name descname">merge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">graph2graph</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.merge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge multiple graphs into a single graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>graph2graph</strong> (<em>array_like</em>) – ID of the new graph each graph belongs to</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.node_mask">
<code class="sig-name descname">node_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="n">compact</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.node_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.node_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a masked packed graph based on the specified nodes.</p>
<p>Note the compact option is only applied to node ids but not graph ids.
To generate compact graph ids, use <a class="reference internal" href="#torchdrug.data.PackedGraph.subbatch" title="torchdrug.data.PackedGraph.subbatch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subbatch()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – node index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact node ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.repeat">
<code class="sig-name descname">repeat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">count</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.repeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.repeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeat this packed graph. This function behaves similarly to <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.repeat.html">torch.Tensor.repeat</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>count</strong> (<em>int</em>) – number of repetitions</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.repeat_interleave">
<code class="sig-name descname">repeat_interleave</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">repeats</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.repeat_interleave"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.repeat_interleave" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeat this packed graph. This function behaves similarly to <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.repeat_interleave.html">torch.repeat_interleave</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>repeats</strong> (<em>Tensor</em>) – number of repetitions for each graph</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.subbatch">
<code class="sig-name descname">subbatch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.subbatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.subbatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a subbatch based on the specified graphs.
Equivalent to <a class="reference internal" href="#torchdrug.data.PackedGraph.graph_mask" title="torchdrug.data.PackedGraph.graph_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">graph_mask(index,</span> <span class="pre">compact=True)</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – graph index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#torchdrug.data.PackedGraph.graph_mask" title="torchdrug.data.PackedGraph.graph_mask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PackedGraph.graph_mask()</span></code></a></p>
</div>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.undirected">
<code class="sig-name descname">undirected</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">add_inverse</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.undirected"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.undirected" title="Permalink to this definition">¶</a></dt>
<dd><p>Flip all the edges to create undirected graphs.</p>
<p>For knowledge graphs, the flipped edges can either have the original relation or an inverse relation.
The inverse relation for relation <span class="math notranslate nohighlight">\(r\)</span> is defined as <span class="math notranslate nohighlight">\(|R| + r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>add_inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to use inverse relations for flipped edges</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.unpack">
<code class="sig-name descname">unpack</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.unpack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack this packed graph into a list of graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of Graph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.unpack_data">
<code class="sig-name descname">unpack_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">type</span><span class="o">=</span><span class="default_value">'auto'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.unpack_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.unpack_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack node or edge data according to the packed graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Tensor</em>) – data to unpack</p></li>
<li><p><strong>type</strong> (<em>str</em><em>, </em><em>optional</em>) – data type. Can be <code class="docutils literal notranslate"><span class="pre">auto</span></code>, <code class="docutils literal notranslate"><span class="pre">node</span></code>, or <code class="docutils literal notranslate"><span class="pre">edge</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of Tensor</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.visualize">
<code class="sig-name descname">visualize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">titles</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figure_size</span><span class="o">=</span><span class="default_value">3, 3</span></em>, <em class="sig-param"><span class="n">layout</span><span class="o">=</span><span class="default_value">'spring'</span></em>, <em class="sig-param"><span class="n">num_row</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_col</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/graph.html#PackedGraph.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedGraph.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the packed graphs with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>titles</strong> (<em>list of str</em><em>, </em><em>optional</em>) – title for each graph. Default is the ID of each graph.</p></li>
<li><p><strong>save_file</strong> (<em>str</em><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">png</span></code> or <code class="docutils literal notranslate"><span class="pre">pdf</span></code> file to save visualization.
If not provided, show the figure in window.</p></li>
<li><p><strong>figure_size</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – width and height of the figure</p></li>
<li><p><strong>layout</strong> (<em>str</em><em>, </em><em>optional</em>) – graph layout</p></li>
<li><p><strong>num_row</strong> (<em>int</em><em>, </em><em>optional</em>) – number of rows in the figure</p></li>
<li><p><strong>num_col</strong> (<em>int</em><em>, </em><em>optional</em>) – number of columns in the figure</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/reference/drawing.html#module-networkx.drawing.layout">NetworkX graph layout</a></p>
</div>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.batch_size">
<em class="property">property </em><code class="sig-name descname">batch_size</code><a class="headerlink" href="#torchdrug.data.PackedGraph.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch size.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.edge2graph">
<em class="property">property </em><code class="sig-name descname">edge2graph</code><a class="headerlink" href="#torchdrug.data.PackedGraph.edge2graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Edge id to graph id mapping.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedGraph.node2graph">
<em class="property">property </em><code class="sig-name descname">node2graph</code><a class="headerlink" href="#torchdrug.data.PackedGraph.node2graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Node id to graph id mapping.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="packedmolecule">
<h3>PackedMolecule<a class="headerlink" href="#packedmolecule" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="torchdrug.data.PackedMolecule">
<em class="property">class </em><code class="sig-name descname">PackedMolecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">edge_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">atom_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bond_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_nodes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_edges</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsets</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for molecules with variadic sizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – list of edges of shape <span class="math notranslate nohighlight">\((|E|, 3)\)</span>.
Each tuple is (node_in, node_out, bond_type).</p></li>
<li><p><strong>atom_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – atom types of shape <span class="math notranslate nohighlight">\((|V|,)\)</span></p></li>
<li><p><strong>bond_type</strong> (<em>array_like</em><em>, </em><em>optional</em>) – bond types of shape <span class="math notranslate nohighlight">\((|E|,)\)</span></p></li>
<li><p><strong>num_nodes</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of nodes in each graph
By default, it will be inferred from the largest id in <cite>edge_list</cite></p></li>
<li><p><strong>num_edges</strong> (<em>array_like</em><em>, </em><em>optional</em>) – number of edges in each graph</p></li>
<li><p><strong>num_relation</strong> (<em>int</em><em>, </em><em>optional</em>) – number of relations</p></li>
<li><p><strong>offsets</strong> (<em>array_like</em><em>, </em><em>optional</em>) – node id offsets of shape <span class="math notranslate nohighlight">\((|E|,)\)</span>.
If not provided, nodes in <cite>edge_list</cite> should be relative index, i.e., the index in each graph.
If provided, nodes in <cite>edge_list</cite> should be absolute index, i.e., the index in the packed graph.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="torchdrug.data.PackedMolecule.unpacked_type">
<code class="sig-name descname">unpacked_type</code><a class="headerlink" href="#torchdrug.data.PackedMolecule.unpacked_type" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#torchdrug.data.Molecule" title="torchdrug.data.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedMolecule.edge_mask">
<code class="sig-name descname">edge_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.edge_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.edge_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a masked packed graph based on the specified edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>array_like</em>) – edge index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedMolecule.from_molecule">
<em class="property">classmethod </em><code class="sig-name descname">from_molecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mols</span></em>, <em class="sig-param"><span class="n">node_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">edge_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">graph_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">with_hydrogen</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">kekulize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.from_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.from_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a packed molecule from a list of RDKit objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mols</strong> (<em>list of rdchem.Mol</em>) – molecules</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – node features to extract</p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – edge features to extract</p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – graph features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedMolecule.from_smiles">
<em class="property">classmethod </em><code class="sig-name descname">from_smiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smiles_list</span></em>, <em class="sig-param"><span class="n">node_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">edge_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">graph_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">with_hydrogen</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">kekulize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.from_smiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.from_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a packed molecule from a list of SMILES strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_list</strong> (<em>str</em>) – list of SMILES strings</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – node features to extract</p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – edge features to extract</p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – graph features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedMolecule.ion_to_molecule">
<code class="sig-name descname">ion_to_molecule</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.ion_to_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.ion_to_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert ions to molecules by adjusting hydrogens and electrons.</p>
<p>Note [N+] will not be converted.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedMolecule.node_mask">
<code class="sig-name descname">node_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="n">compact</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.node_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.node_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a masked packed graph based on the specified nodes.</p>
<p>Note the compact option is only applied to node ids but not graph ids.
To generate compact graph ids, use <code class="xref py py-meth docutils literal notranslate"><span class="pre">subbatch()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>array_like</em>) – node index</p></li>
<li><p><strong>compact</strong> (<em>bool</em><em>, </em><em>optional</em>) – compact node ids or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PackedGraph</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedMolecule.to_molecule">
<code class="sig-name descname">to_molecule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ignore_error</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.to_molecule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.to_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of RDKit objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ignore_error</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true, return <code class="docutils literal notranslate"><span class="pre">None</span></code> for illegal molecules.
Otherwise, raise an exception.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of rdchem.Mol</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedMolecule.to_smiles">
<code class="sig-name descname">to_smiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">isomeric</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">atom_map</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">canonical</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.to_smiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.to_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of SMILES strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isomeric</strong> (<em>bool</em><em>, </em><em>optional</em>) – keep isomeric information or not</p></li>
<li><p><strong>atom_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – keep atom mapping or not</p></li>
<li><p><strong>canonical</strong> (<em>bool</em><em>, </em><em>optional</em>) – if true, return the canonical form of smiles</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of str</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedMolecule.undirected">
<code class="sig-name descname">undirected</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">add_inverse</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.undirected"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.undirected" title="Permalink to this definition">¶</a></dt>
<dd><p>Flip all the edges to create undirected graphs.</p>
<p>For knowledge graphs, the flipped edges can either have the original relation or an inverse relation.
The inverse relation for relation <span class="math notranslate nohighlight">\(r\)</span> is defined as <span class="math notranslate nohighlight">\(|R| + r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>add_inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to use inverse relations for flipped edges</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedMolecule.visualize">
<code class="sig-name descname">visualize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">titles</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figure_size</span><span class="o">=</span><span class="default_value">3, 3</span></em>, <em class="sig-param"><span class="n">num_row</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">atom_map</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/molecule.html#PackedMolecule.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.PackedMolecule.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the packed molecules with matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>titles</strong> (<em>list of str</em><em>, </em><em>optional</em>) – title for each molecule. Default is the ID of each molecule.</p></li>
<li><p><strong>save_file</strong> (<em>str</em><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">png</span></code> or <code class="docutils literal notranslate"><span class="pre">pdf</span></code> file to save visualization.
If not provided, show the figure in window.</p></li>
<li><p><strong>figure_size</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – width and height of the figure</p></li>
<li><p><strong>num_row</strong> (<em>int</em><em>, </em><em>optional</em>) – number of rows in the figure</p></li>
<li><p><strong>num_col</strong> (<em>int</em><em>, </em><em>optional</em>) – number of columns in the figure</p></li>
<li><p><strong>atom_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – visualize atom mapping or not</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.PackedMolecule.is_valid">
<em class="property">property </em><code class="sig-name descname">is_valid</code><a class="headerlink" href="#torchdrug.data.PackedMolecule.is_valid" title="Permalink to this definition">¶</a></dt>
<dd><p>A coarse implementation of valence check.</p>
</dd></dl>
</dd></dl>
</div>
</div>
<div class="section" id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline">¶</a></h2>
<div class="section" id="knowledgegraphdataset">
<h3>KnowledgeGraphDataset<a class="headerlink" href="#knowledgegraphdataset" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="torchdrug.data.KnowledgeGraphDataset">
<em class="property">class </em><code class="sig-name descname">KnowledgeGraphDataset</code><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#KnowledgeGraphDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Knowledge graph dataset.</p>
<p>The whole dataset contains one knowledge graph.</p>
<dl class="py method">
<dt id="torchdrug.data.KnowledgeGraphDataset.load_triplet">
<code class="sig-name descname">load_triplet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">triplets</span></em>, <em class="sig-param"><span class="n">entity_vocab</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">relation_vocab</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inv_entity_vocab</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inv_relation_vocab</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#KnowledgeGraphDataset.load_triplet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.load_triplet" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the dataset from triplets.
The mapping between indexes and tokens is specified through either vocabularies or inverse vocabularies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>triplets</strong> (<em>array_like</em>) – triplets of shape <span class="math notranslate nohighlight">\((n, 3)\)</span></p></li>
<li><p><strong>entity_vocab</strong> (<em>dict of str</em><em>, </em><em>optional</em>) – maps entity indexes to tokens</p></li>
<li><p><strong>relation_vocab</strong> (<em>dict of str</em><em>, </em><em>optional</em>) – maps relation indexes to tokens</p></li>
<li><p><strong>inv_entity_vocab</strong> (<em>dict of str</em><em>, </em><em>optional</em>) – maps tokens to entity indexes</p></li>
<li><p><strong>inv_relation_vocab</strong> (<em>dict of str</em><em>, </em><em>optional</em>) – maps tokens to relation indexes</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.KnowledgeGraphDataset.load_tsv">
<code class="sig-name descname">load_tsv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsv_file</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#KnowledgeGraphDataset.load_tsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.load_tsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the dataset from a tsv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tsv_file</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.KnowledgeGraphDataset.load_tsvs">
<code class="sig-name descname">load_tsvs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tsv_files</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#KnowledgeGraphDataset.load_tsvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.load_tsvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the dataset from multiple tsv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tsv_files</strong> (<em>list of str</em>) – list of file names</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.KnowledgeGraphDataset.num_entity">
<em class="property">property </em><code class="sig-name descname">num_entity</code><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.num_entity" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of entities.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.KnowledgeGraphDataset.num_relation">
<em class="property">property </em><code class="sig-name descname">num_relation</code><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.num_relation" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of relations.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.KnowledgeGraphDataset.num_triplet">
<em class="property">property </em><code class="sig-name descname">num_triplet</code><a class="headerlink" href="#torchdrug.data.KnowledgeGraphDataset.num_triplet" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of triplets.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="moleculedataset">
<h3>MoleculeDataset<a class="headerlink" href="#moleculedataset" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="torchdrug.data.MoleculeDataset">
<em class="property">class </em><code class="sig-name descname">MoleculeDataset</code><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#MoleculeDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.MoleculeDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Molecule dataset.</p>
<p>Each sample contains a molecule graph, and any number of prediction targets.</p>
<dl class="py method">
<dt id="torchdrug.data.MoleculeDataset.load_csv">
<code class="sig-name descname">load_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">csv_file</span></em>, <em class="sig-param"><span class="n">smiles_field</span><span class="o">=</span><span class="default_value">'smiles'</span></em>, <em class="sig-param"><span class="n">target_fields</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">transform</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lazy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">node_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">edge_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">graph_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">with_hydrogen</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">kekulize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#MoleculeDataset.load_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.MoleculeDataset.load_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the dataset from a csv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>csv_file</strong> (<em>str</em>) – file name</p></li>
<li><p><strong>smiles_field</strong> (<em>str</em><em>, </em><em>optional</em>) – name of SMILES column in the table.
Use <code class="docutils literal notranslate"><span class="pre">None</span></code> if there is no SMILES column.</p></li>
<li><p><strong>target_fields</strong> (<em>list of str</em><em>, </em><em>optional</em>) – name of target columns in the table.
Default is all columns other than the SMILES column.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – data transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the molecules are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – node features to extract</p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – edge features to extract</p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – graph features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.MoleculeDataset.load_smiles">
<code class="sig-name descname">load_smiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smiles_list</span></em>, <em class="sig-param"><span class="n">targets</span></em>, <em class="sig-param"><span class="n">transform</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lazy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">node_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">edge_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">graph_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">with_hydrogen</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">kekulize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#MoleculeDataset.load_smiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.MoleculeDataset.load_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the dataset from SMILES and targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_list</strong> (<em>list of str</em>) – SMILES strings</p></li>
<li><p><strong>targets</strong> (<em>dict of list</em>) – prediction targets</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – data transformation function</p></li>
<li><p><strong>lazy</strong> (<em>bool</em><em>, </em><em>optional</em>) – if lazy mode is used, the molecules are processed in the dataloader.
This may slow down the data loading process, but save a lot of CPU memory and dataset loading time.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – node features to extract</p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – edge features to extract</p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – graph features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.MoleculeDataset.atom_types">
<em class="property">property </em><code class="sig-name descname">atom_types</code><a class="headerlink" href="#torchdrug.data.MoleculeDataset.atom_types" title="Permalink to this definition">¶</a></dt>
<dd><p>All atom types.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.MoleculeDataset.bond_types">
<em class="property">property </em><code class="sig-name descname">bond_types</code><a class="headerlink" href="#torchdrug.data.MoleculeDataset.bond_types" title="Permalink to this definition">¶</a></dt>
<dd><p>All bond types.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.MoleculeDataset.edge_feature_dim">
<em class="property">property </em><code class="sig-name descname">edge_feature_dim</code><a class="headerlink" href="#torchdrug.data.MoleculeDataset.edge_feature_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of edge features.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.MoleculeDataset.node_feature_dim">
<em class="property">property </em><code class="sig-name descname">node_feature_dim</code><a class="headerlink" href="#torchdrug.data.MoleculeDataset.node_feature_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of node features.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.MoleculeDataset.num_atom_type">
<em class="property">property </em><code class="sig-name descname">num_atom_type</code><a class="headerlink" href="#torchdrug.data.MoleculeDataset.num_atom_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of different atom types.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.MoleculeDataset.num_bond_type">
<em class="property">property </em><code class="sig-name descname">num_bond_type</code><a class="headerlink" href="#torchdrug.data.MoleculeDataset.num_bond_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of different bond types.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.MoleculeDataset.tasks">
<em class="property">property </em><code class="sig-name descname">tasks</code><a class="headerlink" href="#torchdrug.data.MoleculeDataset.tasks" title="Permalink to this definition">¶</a></dt>
<dd><p>List of tasks.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="nodeclassificationdataset">
<h3>NodeClassificationDataset<a class="headerlink" href="#nodeclassificationdataset" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="torchdrug.data.NodeClassificationDataset">
<em class="property">class </em><code class="sig-name descname">NodeClassificationDataset</code><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#NodeClassificationDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.NodeClassificationDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Node classification dataset.</p>
<p>The whole dataset contains one graph, where each node has its own node feature and label.</p>
<dl class="py method">
<dt id="torchdrug.data.NodeClassificationDataset.load_tsv">
<code class="sig-name descname">load_tsv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node_file</span></em>, <em class="sig-param"><span class="n">edge_file</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#NodeClassificationDataset.load_tsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.NodeClassificationDataset.load_tsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the edge list from a tsv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node_file</strong> (<em>str</em>) – node feature and label file</p></li>
<li><p><strong>edge_file</strong> (<em>str</em>) – edge list file</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.NodeClassificationDataset.node_feature_dim">
<em class="property">property </em><code class="sig-name descname">node_feature_dim</code><a class="headerlink" href="#torchdrug.data.NodeClassificationDataset.node_feature_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of node features.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.NodeClassificationDataset.num_edge">
<em class="property">property </em><code class="sig-name descname">num_edge</code><a class="headerlink" href="#torchdrug.data.NodeClassificationDataset.num_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of edges.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.NodeClassificationDataset.num_node">
<em class="property">property </em><code class="sig-name descname">num_node</code><a class="headerlink" href="#torchdrug.data.NodeClassificationDataset.num_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="reactiondataset">
<h3>ReactionDataset<a class="headerlink" href="#reactiondataset" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="torchdrug.data.ReactionDataset">
<em class="property">class </em><code class="sig-name descname">ReactionDataset</code><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ReactionDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.ReactionDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Chemical reaction dataset.</p>
<p>Each sample contains two molecule graphs, and any number of prediction targets.</p>
<dl class="py method">
<dt id="torchdrug.data.ReactionDataset.load_smiles">
<code class="sig-name descname">load_smiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smiles_list</span></em>, <em class="sig-param"><span class="n">targets</span></em>, <em class="sig-param"><span class="n">transform</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">node_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">edge_feature</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">graph_feature</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">with_hydrogen</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">kekulize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ReactionDataset.load_smiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.ReactionDataset.load_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the dataset from SMILES and targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles_list</strong> (<em>list of str</em>) – SMILES strings</p></li>
<li><p><strong>targets</strong> (<em>dict of list</em>) – prediction targets</p></li>
<li><p><strong>transform</strong> (<em>Callable</em><em>, </em><em>optional</em>) – data transformation function</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – output verbose level</p></li>
<li><p><strong>node_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – node features to extract</p></li>
<li><p><strong>edge_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – edge features to extract</p></li>
<li><p><strong>graph_feature</strong> (<em>str</em><em> or </em><em>list of str</em><em>, </em><em>optional</em>) – graph features to extract</p></li>
<li><p><strong>with_hydrogen</strong> (<em>bool</em><em>, </em><em>optional</em>) – store hydrogens in the molecule graph.
By default, hydrogens are dropped</p></li>
<li><p><strong>kekulize</strong> (<em>bool</em><em>, </em><em>optional</em>) – convert aromatic bonds to single/double bonds.
Note this only affects the relation in <code class="docutils literal notranslate"><span class="pre">edge_list</span></code>.
For <code class="docutils literal notranslate"><span class="pre">bond_type</span></code>, aromatic bonds are always stored explicitly.
By default, aromatic bonds are stored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.ReactionDataset.atom_types">
<em class="property">property </em><code class="sig-name descname">atom_types</code><a class="headerlink" href="#torchdrug.data.ReactionDataset.atom_types" title="Permalink to this definition">¶</a></dt>
<dd><p>All atom types.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.ReactionDataset.bond_types">
<em class="property">property </em><code class="sig-name descname">bond_types</code><a class="headerlink" href="#torchdrug.data.ReactionDataset.bond_types" title="Permalink to this definition">¶</a></dt>
<dd><p>All bond types.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.ReactionDataset.edge_feature_dim">
<em class="property">property </em><code class="sig-name descname">edge_feature_dim</code><a class="headerlink" href="#torchdrug.data.ReactionDataset.edge_feature_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of edge features.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.ReactionDataset.node_feature_dim">
<em class="property">property </em><code class="sig-name descname">node_feature_dim</code><a class="headerlink" href="#torchdrug.data.ReactionDataset.node_feature_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimension of node features.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.ReactionDataset.num_atom_type">
<em class="property">property </em><code class="sig-name descname">num_atom_type</code><a class="headerlink" href="#torchdrug.data.ReactionDataset.num_atom_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of different atom types.</p>
</dd></dl>
<dl class="py method">
<dt id="torchdrug.data.ReactionDataset.num_bond_type">
<em class="property">property </em><code class="sig-name descname">num_bond_type</code><a class="headerlink" href="#torchdrug.data.ReactionDataset.num_bond_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of different bond types.</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="semisupervised">
<h3>SemiSupervised<a class="headerlink" href="#semisupervised" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="torchdrug.data.SemiSupervised">
<em class="property">class </em><code class="sig-name descname">SemiSupervised</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">indices</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#SemiSupervised"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.SemiSupervised" title="Permalink to this definition">¶</a></dt>
<dd><p>Semi-supervised dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – supervised dataset</p></li>
<li><p><strong>indices</strong> (<em>list of int</em>) – sample indices to keep supervision</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</div>
</div>
<div class="section" id="data-processing">
<h2>Data Processing<a class="headerlink" href="#data-processing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dataloader">
<h3>DataLoader<a class="headerlink" href="#dataloader" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="torchdrug.data.DataLoader">
<em class="property">class </em><code class="sig-name descname">DataLoader</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">batch_size=1</em>, <em class="sig-param">shuffle=False</em>, <em class="sig-param">sampler=None</em>, <em class="sig-param">batch_sampler=None</em>, <em class="sig-param">num_workers=0</em>, <em class="sig-param">collate_fn=&lt;function graph_collate&gt;</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataloader.html#DataLoader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.DataLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Extended data loader for batching graph structured data.</p>
<p>See <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader">torch.utils.data.DataLoader</a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – dataset from which to load the data</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – how many samples per batch to load</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to have the data reshuffled at every epoch</p></li>
<li><p><strong>sampler</strong> (<em>Sampler</em><em>, </em><em>optional</em>) – sampler that draws single sample from the dataset</p></li>
<li><p><strong>batch_sampler</strong> (<em>Sampler</em><em>, </em><em>optional</em>) – sampler that draws a mini-batch of data from the dataset</p></li>
<li><p><strong>num_workers</strong> (<em>int</em><em>, </em><em>optional</em>) – how many subprocesses to use for data loading</p></li>
<li><p><strong>collate_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – merge a list of samples into a mini-batch</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader">torch.utils.data.DataLoader</a></p></li>
</ul>
</dd>
</dl>
</dd></dl>
</div>
<div class="section" id="dataset-split-methods">
<h3>Dataset Split Methods<a class="headerlink" href="#dataset-split-methods" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="torchdrug.data.graph_collate">
<code class="sig-name descname">graph_collate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataloader.html#graph_collate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.graph_collate" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert any list of same nested container into a container of tensors.</p>
<p>For instances of <a class="reference internal" href="#torchdrug.data.Graph" title="torchdrug.data.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">data.Graph</span></code></a>, they are collated
by <a class="reference internal" href="#torchdrug.data.Graph.pack" title="torchdrug.data.Graph.pack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">data.Graph.pack</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch</strong> (<em>list</em>) – list of samples with the same nested container</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.key_split">
<code class="sig-name descname">key_split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">keys</span></em>, <em class="sig-param"><span class="n">lengths</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">key_lengths</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#key_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.key_split" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py function">
<dt id="torchdrug.data.ordered_scaffold_split">
<code class="sig-name descname">ordered_scaffold_split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">lengths</span></em>, <em class="sig-param"><span class="n">chirality</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#ordered_scaffold_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.ordered_scaffold_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a dataset into new datasets with non-overlapping scaffolds and sorted w.r.t. number of each scaffold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – dataset to split</p></li>
<li><p><strong>lengths</strong> (<em>list of int</em>) – expected length for each split.
Note the results may be different in length due to rounding.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.scaffold_split">
<code class="sig-name descname">scaffold_split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">lengths</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#scaffold_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.scaffold_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly split a dataset into new datasets with non-overlapping scaffolds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – dataset to split</p></li>
<li><p><strong>lengths</strong> (<em>list of int</em>) – expected length for each split.
Note the results may be different in length due to rounding.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.semisupervised">
<code class="sig-name descname">semisupervised</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">length</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/dataset.html#semisupervised"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.semisupervised" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly construct a semi-supervised dataset based on the given length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – supervised dataset</p></li>
<li><p><strong>length</strong> (<em>int</em>) – length of supervised data to keep</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</div>
</div>
<div class="section" id="feature-functions">
<h2>Feature Functions<a class="headerlink" href="#feature-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="atom-features">
<h3>Atom Features<a class="headerlink" href="#atom-features" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="torchdrug.data.feature.atom_default">
<code class="sig-name descname">atom_default</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_default"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.atom_default" title="Permalink to this definition">¶</a></dt>
<dd><p>Default atom feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetChiralTag(): one-hot embedding for atomic chiral tag</p>
<p>GetTotalDegree(): one-hot embedding for the degree of the atom in the molecule including Hs</p>
<p>GetFormalCharge(): one-hot embedding for the number of formal charges in the molecule</p>
<p>GetTotalNumHs(): one-hot embedding for the total number of Hs (explicit and implicit) on the atom</p>
<p>GetNumRadicalElectrons(): one-hot embedding for the number of radical electrons on the atom</p>
<p>GetHybridization(): one-hot embedding for the atom’s hybridization</p>
<p>GetIsAromatic(): whether the atom is aromatic</p>
<p>IsInRing(): whether the atom is in a ring</p>
<p>atom_position(): the 3D position of the atom</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.atom_symbol">
<code class="sig-name descname">atom_symbol</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.atom_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Symbol atom feature.</p>
<dl class="simple">
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.atom_position">
<code class="sig-name descname">atom_position</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.atom_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Atom position.
Return 3D position if available, otherwise 2D position is returned.</p>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.atom_property_prediction">
<code class="sig-name descname">atom_property_prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_property_prediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.atom_property_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Property prediction atom feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetDegree(): one-hot embedding for the degree of the atom in the molecule</p>
<p>GetTotalNumHs(): one-hot embedding for the total number of Hs (explicit and implicit) on the atom</p>
<p>GetTotalValence(): one-hot embedding for the total valence (explicit + implicit) of the atom</p>
<p>GetFormalCharge(): one-hot embedding for the number of formal charges in the molecule</p>
<p>GetIsAromatic(): whether the atom is aromatic</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.atom_explicit_property_prediction">
<code class="sig-name descname">atom_explicit_property_prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_explicit_property_prediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.atom_explicit_property_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Explicit property prediction atom feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetDegree(): one-hot embedding for the degree of the atom in the molecule</p>
<p>GetTotalValence(): one-hot embedding for the total valence (explicit + implicit) of the atom</p>
<p>GetFormalCharge(): one-hot embedding for the number of formal charges in the molecule</p>
<p>GetIsAromatic(): whether the atom is aromatic</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.atom_pretrain">
<code class="sig-name descname">atom_pretrain</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_pretrain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.atom_pretrain" title="Permalink to this definition">¶</a></dt>
<dd><p>Atom feature for pretraining.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetChiralTag(): one-hot embedding for atomic chiral tag</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.atom_center_identification">
<code class="sig-name descname">atom_center_identification</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_center_identification"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.atom_center_identification" title="Permalink to this definition">¶</a></dt>
<dd><p>Reaction center identification atom feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetTotalNumHs(): one-hot embedding for the total number of Hs (explicit and implicit) on the atom</p>
<p>GetTotalDegree(): one-hot embedding for the degree of the atom in the molecule including Hs</p>
<p>GetTotalValence(): one-hot embedding for the total valence (explicit + implicit) of the atom</p>
<p>GetIsAromatic(): whether the atom is aromatic</p>
<p>IsInRing(): whether the atom is in a ring</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.atom_synthon_completion">
<code class="sig-name descname">atom_synthon_completion</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#atom_synthon_completion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.atom_synthon_completion" title="Permalink to this definition">¶</a></dt>
<dd><p>Synthon completion atom feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetSymbol(): one-hot embedding for the atomic symbol</p>
<p>GetTotalNumHs(): one-hot embedding for the total number of Hs (explicit and implicit) on the atom</p>
<p>GetTotalDegree(): one-hot embedding for the degree of the atom in the molecule including Hs</p>
<p>IsInRing(): whether the atom is in a ring</p>
<p>IsInRingSize(3, 4, 5, 6): whether the atom is in a ring of a particular size</p>
<p>IsInRing() and not IsInRingSize(3, 4, 5, 6): whether the atom is in a ring and not in a ring of 3, 4, 5, 6</p>
</dd>
</dl>
</dd></dl>
</div>
<div class="section" id="bond-features">
<h3>Bond Features<a class="headerlink" href="#bond-features" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="torchdrug.data.feature.bond_default">
<code class="sig-name descname">bond_default</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bond</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#bond_default"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.bond_default" title="Permalink to this definition">¶</a></dt>
<dd><p>Default bond feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetBondType(): one-hot embedding for the type of the bond</p>
<p>GetBondDir(): one-hot embedding for the direction of the bond</p>
<p>GetStereo(): one-hot embedding for the stereo configuration of the bond</p>
<p>GetIsConjugated(): whether the bond is considered to be conjugated</p>
<p>bond_length: the length of the bond</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.bond_length">
<code class="sig-name descname">bond_length</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bond</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#bond_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.bond_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Bond length</p>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.bond_property_prediction">
<code class="sig-name descname">bond_property_prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bond</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#bond_property_prediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.bond_property_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Property prediction bond feature.</p>
<dl>
<dt>Features:</dt><dd><p>GetBondType(): one-hot embedding for the type of the bond</p>
<p>GetIsConjugated(): whether the bond is considered to be conjugated</p>
<p>IsInRing(): whether the bond is in a ring</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.bond_pretrain">
<code class="sig-name descname">bond_pretrain</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bond</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#bond_pretrain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.bond_pretrain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bond feature for pretraining.</p>
<dl>
<dt>Features:</dt><dd><p>GetBondType(): one-hot embedding for the type of the bond</p>
<p>GetBondDir(): one-hot embedding for the direction of the bond</p>
</dd>
</dl>
</dd></dl>
</div>
<div class="section" id="molecule-features">
<h3>Molecule Features<a class="headerlink" href="#molecule-features" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="torchdrug.data.feature.molecule_default">
<code class="sig-name descname">molecule_default</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#molecule_default"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.molecule_default" title="Permalink to this definition">¶</a></dt>
<dd><p>Default molecule feature.</p>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.ExtendedConnectivityFingerprint">
<code class="sig-name descname">ExtendedConnectivityFingerprint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span></em>, <em class="sig-param"><span class="n">radius</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">length</span><span class="o">=</span><span class="default_value">1024</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torchdrug/data/feature.html#ExtendedConnectivityFingerprint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchdrug.data.feature.ExtendedConnectivityFingerprint" title="Permalink to this definition">¶</a></dt>
<dd><p>Extended Connectivity Fingerprint molecule feature.</p>
<dl class="simple">
<dt>Features:</dt><dd><p>GetMorganFingerprintAsBitVect(): a Morgan fingerprint for a molecule as a bit vector</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="torchdrug.data.feature.ECFP">
<code class="sig-name descname">ECFP</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#torchdrug.data.feature.ECFP" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="docutils literal notranslate"><span class="pre">torchdrug.data.feature.ExtendedConnectivityFingerprint</span></code></p>
</dd></dl>
</div>
</div>
<div class="section" id="element-constants">
<h2>Element Constants<a class="headerlink" href="#element-constants" title="Permalink to this headline">¶</a></h2>
<p>Element constants are provided for convenient manipulating of atom types. The atomic
numbers can be accessed by uppercased element names at the root of the package. For
example, we can get the carbon scaffold of a molecule with the following code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torchdrug</span> <span class="k">as</span> <span class="nn">td</span>
<span class="kn">from</span> <span class="nn">torchdrug</span> <span class="kn">import</span> <span class="n">data</span>

<span class="n">smiles</span> <span class="o">=</span> <span class="s2">"CC1=C(C=C(C=C1[N+](=O)[O-])[N+](=O)[O-])[N+](=O)[O-]"</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_smiles</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
<span class="n">scaffold</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">subgraph</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">atom_type</span> <span class="o">==</span> <span class="n">td</span><span class="o">.</span><span class="n">CARBON</span><span class="p">)</span>
<span class="n">mol</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
<span class="n">scaffold</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/tnt.png"><img alt="../_images/tnt.png" src="../_images/tnt.png" style="width: 33%;"/></a>
<a class="reference internal image-reference" href="../_images/tnt_carbon_scaffold.png"><img alt="../_images/tnt_carbon_scaffold.png" src="../_images/tnt_carbon_scaffold.png" style="width: 33%;"/></a>
<p>There are also 2 constant arrays that map atomic numbers to element names.
<code class="docutils literal notranslate"><span class="pre">td.ATOM_NAME[i]</span></code> returns the full name, while <code class="docutils literal notranslate"><span class="pre">td.ATOM_SYMBOL[i]</span></code> returns the
abbreviated chemical symbol for atomic number <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p>
<p>For a full list of elements, please refer to <a class="reference external" href="https://en.wikipedia.org/wiki/Periodic_table">the perodic table</a>.</p>
</div>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="datasets.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">torchdrug.datasets</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="core.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">torchdrug.core</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, MilaGraph Group
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            |
            <a class="muted-link" href="../_sources/api/data.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">torchdrug.data</a><ul>
<li><a class="reference internal" href="#data-structures">Data Structures</a><ul>
<li><a class="reference internal" href="#graph">Graph</a></li>
<li><a class="reference internal" href="#molecule">Molecule</a></li>
<li><a class="reference internal" href="#packedgraph">PackedGraph</a></li>
<li><a class="reference internal" href="#packedmolecule">PackedMolecule</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datasets">Datasets</a><ul>
<li><a class="reference internal" href="#knowledgegraphdataset">KnowledgeGraphDataset</a></li>
<li><a class="reference internal" href="#moleculedataset">MoleculeDataset</a></li>
<li><a class="reference internal" href="#nodeclassificationdataset">NodeClassificationDataset</a></li>
<li><a class="reference internal" href="#reactiondataset">ReactionDataset</a></li>
<li><a class="reference internal" href="#semisupervised">SemiSupervised</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-processing">Data Processing</a><ul>
<li><a class="reference internal" href="#dataloader">DataLoader</a></li>
<li><a class="reference internal" href="#dataset-split-methods">Dataset Split Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#feature-functions">Feature Functions</a><ul>
<li><a class="reference internal" href="#atom-features">Atom Features</a></li>
<li><a class="reference internal" href="#bond-features">Bond Features</a></li>
<li><a class="reference internal" href="#molecule-features">Molecule Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#element-constants">Element Constants</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </main>
</div>
  </body>
</html>